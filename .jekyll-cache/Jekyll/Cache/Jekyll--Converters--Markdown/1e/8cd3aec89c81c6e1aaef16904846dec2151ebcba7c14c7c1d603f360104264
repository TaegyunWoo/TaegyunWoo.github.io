I"«ª<p><br/><br/></p>
<ul>
<li>ì´ì „ ê²Œì‹œê¸€
<ol>
<li><a href="https://taegyunwoo.github.io/jpa/JPA_ObjectQuery_Begin">[JPA] ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ - ì†Œê°œ</a></li>
<li><a href="https://taegyunwoo.github.io/jpa/JPA_ObjectQuery_JPQL_Begin">[JPA] ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ - JPQL ê¸°ì´ˆ</a></li>
<li><a href="https://taegyunwoo.github.io/jpa/JPA_ObjectQuery_JPQL_Join">[JPA] ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ - JPQL ì¡°ì¸</a></li>
<li><a href="https://taegyunwoo.github.io/jpa/JPA_ObjectQuery_JPQL_Expert">[JPA] ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ - JPQL ì‹¬í™”</a></li>
<li><a href="https://taegyunwoo.github.io/jpa/JPA_ObjectQuery_QueryDSL">[JPA] ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì–¸ì–´ - QueryDSL</a></li>
</ol>
</li>
</ul>
<p><br/><br/></p>
<h1 id="sql">ë„¤ì´í‹°ë¸Œ SQL</h1>
<h2 id="section">ê°œìš”</h2>
<h3 id="sql--">ë„¤ì´í‹°ë¸Œ SQLì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ </h3>
<ul>
<li>JPQLì€ í‘œì¤€ SQLì´ ì§€ì›í•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ë¬¸ë²•ê³¼ SQL í•¨ìˆ˜ë“¤ì„ ì§€ì›í•œë‹¤.</li>
<li>í•˜ì§€ë§Œ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì¢…ì†ì ì¸ ê¸°ëŠ¥ì€ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ë•Œ, ë„¤ì´í‹°ë¸Œ SQLì„ ì§ì ‘ ì‘ì„±í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
<br/>
<h3 id="section-1">ì¢…ì†ì ì¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•</h3>
<ul>
<li><strong>íŠ¹ì • DBë§Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸°</strong>
<ul>
<li>ë„¤ì´í‹°ë¸Œ SQL í•¨ìˆ˜ í˜¸ì¶œí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
<li>í•˜ì´ë²„ë„¤ì´íŠ¸: DB ë°©ì–¸ì— ê° DBì— ì¢…ì†ì ì„ í•¨ìˆ˜ë“¤ì„ ì •ì˜í•´ë‘ì—ˆê³ , ì´ê²ƒì„ ì§ì ‘ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
<li><strong>íŠ¹ì • DBë§Œ ì§€ì›í•˜ëŠ” SQL ì¿¼ë¦¬ íŒíŠ¸ ì‚¬ìš©í•˜ê¸°</strong>
<ul>
<li>í•˜ì´ë²„ë„¤ì´íŠ¸ë¥¼ í¬í•¨í•œ ëª‡ëª‡ JPA êµ¬í˜„ì²´ë“¤ì´ ì§€ì›í•˜ì—¬, ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
<li><strong>ì¸ë¼ì¸ ë·°(From ì ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” ì„œë¸Œì¿¼ë¦¬), UNION, INTERSECT ì‚¬ìš©í•˜ê¸°</strong>
<ul>
<li>í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>
</li>
<li><strong>ìŠ¤í† ì–´ í”„ë¡œì‹œì € ì‚¬ìš©í•˜ê¸°</strong>
<ul>
<li>JPQLì—ì„œ ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì €ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
<li><strong>íŠ¹ì • DBë§Œ ì§€ì›í•˜ëŠ” ë¬¸ë²• ì‚¬ìš©í•˜ê¸°</strong>
<ul>
<li>ë„ˆë¬´ ì¢…ì†ì ì¸ SQL ë¬¸ë²•ì€ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ë• ë„¤ì´í‹°ë¸Œ SQLì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<h3 id="sql-1">ë„¤ì´í‹°ë¸Œ SQLì´ë€</h3>
<ul>
<li>ìœ„ì²˜ëŸ¼ ë‹¤ì–‘í•œ ì´ìœ ë¡œ JPQLì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ ë•Œ, JPAëŠ” SQLì„ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.
<ul>
<li>ì´ê²ƒì„ ë„¤ì´í‹°ë¸Œ SQLì´ë¼ê³  í•œë‹¤.</li>
</ul>
</li>
<li>ë„¤ì´í‹°ë¸Œ SQLì€ SQLì„ ê°œë°œìê°€ ì§ì ‘ ì •ì˜í•˜ëŠ” ê²ƒì´ë‹¤.</li>
<li><strong>ë„¤ì´í‹°ë¸Œ SQLì„ ì‚¬ìš©í•˜ë©´, ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆê³  JPAê°€ ì§€ì›í•˜ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ê¸°ëŠ¥ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</strong>
<ul>
<li>ë°˜ë©´ JDBC APIë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ë©´, ë‹¨ìˆœíˆ ë°ì´í„°ì˜ ë‚˜ì—´ì„ ì¡°íšŒí•  ë¿ì´ë‹¤.</li>
</ul>
</li>
</ul>
<p><br/><br/></p>
<h2 id="sql-">ë„¤ì´í‹°ë¸Œ SQL ì‚¬ìš©</h2>
<h3 id="api-">ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬ API ì¢…ë¥˜</h3>
<ul>
<li>
<p>ê²°ê³¼ íƒ€ì…ì„ ì •ì˜í•  ìˆ˜ ìˆì„ ë•Œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">Query</span> <span class="nf">createNativeQuery</span><span class="o">(</span><span class="nc">String</span> <span class="n">sqlString</span><span class="o">,</span> <span class="nc">Class</span> <span class="n">resultClass</span><span class="o">);</span>
</code></pre></div></div>
</li>
<li>
<p>ê²°ê³¼ íƒ€ì…ì„ ì •ì˜í•  ìˆ˜ ì—†ì„ ë•Œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ê²°ê³¼ ë§¤í•‘ ë¹„ì‚¬ìš©ì‹œ</span>
<span class="kd">public</span> <span class="nc">Query</span> <span class="nf">createNativeQuery</span><span class="o">(</span><span class="nc">String</span> <span class="n">sqlString</span><span class="o">);</span>
<p><span class="c1">//ê²°ê³¼ ë§¤í•‘ ì‚¬ìš©ì‹œ</span>
<span class="kd">public</span> <span class="nc">Query</span> <span class="nf">createNativeQuery</span><span class="o">(</span><span class="nc">String</span> <span class="n">sqlString</span><span class="o">,</span> <span class="nc">String</span> <span class="n">resultSetMapping</span><span class="o">);</span>
</code></pre></div></div></p>
</li>
</ul>
<br/>
<h3 id="section-2">ì—”í‹°í‹° ì¡°íšŒ</h3>
<ul>
<li>
<p><code>em.createNativeQuery(SQLë¬¸ìì—´, ê²°ê³¼í´ë˜ìŠ¤)</code></p>
<ul>
<li>ë„¤ì´í‹°ë¸Œ SQLì€ í•´ë‹¹ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.</li>
<li>ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„°
<ul>
<li>ë„¤ì´í‹°ë¸Œ SQL ë¬¸ìì—´</li>
</ul>
</li>
<li>ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°
<ul>
<li>ì¡°íšŒí•  ì—”í‹°í‹° í´ë˜ìŠ¤ì˜ íƒ€ì…</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ì—”í‹°í‹° ì¡°íšŒ ì½”ë“œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//SQL ì •ì˜</span>
<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span>
	<span class="s">"SELECT ID, AGE, NAME, TEAM_ID "</span> <span class="o">+</span>
	<span class="s">"FROM MEMBER WHERE AGE &gt; ?"</span><span class="o">;</span>
<p><span class="c1">//ìœ„ì¹˜ê¸°ë°˜ íŒŒë¼ë¯¸í„° ì‚¬ìš©</span>
<span class="nc">Query</span> <span class="n">nativeQuery</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span></p>
<p><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">nativeQuery</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
</code></pre></div></div></p>
<ul>
<li><strong>ë„¤ì´í‹°ë¸Œ SQL ì‚¬ìš© ì‹œ, â€˜ìœ„ì¹˜ ê¸°ë°˜ íŒŒë¼ë¯¸í„°â€™ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</strong></li>
<li><strong>ë„¤ì´í‹°ë¸Œ SQLë¡œ SQLë§Œ ì§ì ‘ ì‚¬ìš©í•  ë¿ì´ê³ , ë‚˜ë¨¸ì§€ëŠ” JPQLì„ ì‚¬ìš©í•  ë•Œì™€ ê°™ë‹¤.</strong>
<ul>
<li><strong>ì¡°íšŒí•œ ì—”í‹°í‹° ì—­ì‹œ, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬ëœë‹¤.</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>JPAëŠ” ê³µì‹ì ìœ¼ë¡œ ë„¤ì´í‹°ë¸Œ SQLì—ì„œ ì´ë¦„ ê¸°ë°˜ íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì›í•˜ì§€ ì•Šê³ , ìœ„ì¹˜ ê¸°ë°˜ íŒŒë¼ë¯¸í„°ë§Œ ì§€ì›í•œë‹¤.<br />
<strong>í•˜ì§€ë§Œ í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ë„¤ì´í‹°ë¸Œ SQLì— ì´ë¦„ ê¸°ë°˜ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ í—ˆìš©í•œë‹¤.</strong></p>
</blockquote>
<blockquote>
<p><code>em.createNativeQuery()</code> ì— ë°˜í™˜íƒ€ì…ì„ ì§€ì •í•´ë„, <code>TypeQuery</code> ê°€ ì•„ë‹Œ <code>Query</code> ë¥¼ ë¦¬í„´í•œë‹¤.<br />
ì´ê²ƒì€ JPAì˜ ê·œì•½ì´ ì •ì˜ë˜ì–´ ê·¸ë ‡ë‹¤. ë„ˆë¬´ ì‹ ê²½ì“°ì§€ ë§ì.</p>
</blockquote>
<br/>
<h3 id="section-3">ê°’ ì¡°íšŒ</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//SQL ì •ì˜</span>
<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span>
	<span class="s">"SELECT ID, AGE, NAME, TEAM_ID "</span> <span class="o">+</span>
	<span class="s">"FROM MEMBER WHERE AGE &gt; ?"</span><span class="o">;</span>
<p><span class="c1">//ì¡°íšŒí•  íƒ€ì…ì´ ì—†ë‹¤.</span>
<span class="nc">Query</span> <span class="n">nativeQuery</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">)</span>
<span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span></p>
<p><span class="c1">//ë”°ë¼ì„œ, Object[] í˜•ìœ¼ë¡œ ê°’ì„ ë°›ëŠ”ë‹¤.</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">[]&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">nativeQuery</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span></p>
<p><span class="k">for</span> <span class="o">(</span><span class="nc">Object</span><span class="o">[]</span> <span class="n">row</span> <span class="o">:</span> <span class="n">resultList</span><span class="o">)</span> <span class="o">{</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">â€œid = â€œ</span> <span class="o">+</span> <span class="n">row</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">â€œage = â€œ</span> <span class="o">+</span> <span class="n">row</span><span class="o">[</span><span class="mi">1</span><span class="o">]);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">â€œname = â€œ</span> <span class="o">+</span> <span class="n">row</span><span class="o">[</span><span class="mi">2</span><span class="o">]);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">â€œteam_id = â€œ</span> <span class="o">+</span> <span class="n">row</span><span class="o">[</span><span class="mi">3</span><span class="o">]);</span>
<span class="o">}</span>
</code></pre></div></div></p>
<ul>
<li><code>em.createNativeQuery()</code>
<ul>
<li>ì—¬ëŸ¬ ê°’ìœ¼ë¡œ ì¡°íšŒí•˜ë ¤ë©´, í•´ë‹¹ ë©”ì„œë“œì˜ ë‘ë²ˆì§¸ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ëœë‹¤.</li>
<li>ì´ë•Œ, <code>Object[]</code> ì— ë‹´ì•„ì„œ ë°˜í™˜ëœë‹¤.</li>
</ul>
</li>
<li>ìŠ¤ì¹¼ë¼ ê°’ë“¤ì„ ì¡°íšŒí•œ ê²ƒì´ë¯€ë¡œ, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>
<br/>
<h3 id="section-4">ê²°ê³¼ ë§¤í•‘ ì‚¬ìš© - 1</h3>
<ul>
<li>ë§¤í•‘ì´ ë³µì¡í•´ì§€ë©´, <code>@SqlResultSetMapping</code> ì• ë„ˆí…Œì´ì…˜ì„ ì •ì˜í•´ì„œ ê²°ê³¼ ë§¤í•‘ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
<ul>
<li>ë§¤í•‘ ë³µì¡í™” ì˜ˆì‹œ) ì—”í‹°í‹°ì™€ ìŠ¤ì¹¼ë¼ ê°’ì„ í•¨ê»˜ ì¡°íšŒí•  ë•Œ</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li>
<p>ì˜ˆì‹œ ì½”ë“œ: ê²°ê³¼ ë§¤í•‘ ì‚¬ìš©</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//SQL ì •ì˜</span>
<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span>
	<span class="s">"SELECT M.ID, AGE, NAME, TEAM_ID, I.ORDER_COUNT "</span> <span class="o">+</span>
	<span class="s">"FROM MEMBER M "</span> <span class="o">+</span>
	<span class="s">"LEFT JOIN "</span> <span class="o">+</span>
		<span class="s">"(SELECT IM.ID, COUNT(*) AS ORDER_COUNT "</span> <span class="o">+</span>
		<span class="s">"FROM ORDERS O, MEMBER IM "</span> <span class="o">+</span>
		<span class="s">"WHERE O.MEMBER_ID = IM.ID) I"</span> <span class="o">+</span>
	<span class="s">"ON M.ID = I.ID"</span><span class="o">;</span>
<p><span class="c1">//â€œmemberWithOrderCountâ€ : ê²°ê³¼ ë§¤í•‘ ì •ë³´ ì´ë¦„</span>
<span class="nc">Query</span> <span class="n">nativeQuery</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="s">â€œmemberWithOrderCountâ€</span><span class="o">);</span></p>
<p><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Object</span><span class="o">[]&gt;</span> <span class="n">resultList</span> <span class="o">=</span> <span class="n">nativeQuery</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span></p>
<p><span class="k">for</span> <span class="o">(</span><span class="nc">Object</span><span class="o">[]</span> <span class="n">row</span> <span class="o">:</span> <span class="n">resultList</span><span class="o">)</span> <span class="o">{</span>
<span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Member</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
<span class="nc">BigInteger</span> <span class="n">orderCount</span> <span class="o">=</span> <span class="o">(</span><span class="nc">BigInteger</span><span class="o">)</span> <span class="n">row</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span></p>
<pre><code>&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;member = &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;member&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;orderCount = &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;orderCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
</code></pre>
<p><span class="o">}</span>
</code></pre></div></div></p>
<ul>
<li><code>em.createNativeQuery(sql, &quot;memberWithOrderCount&quot;)</code>
<ul>
<li>ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì— ê²°ê³¼ ë§¤í•‘ ì •ë³´ì˜ ì´ë¦„ì´ ì‚¬ìš©ë˜ì—ˆë‹¤.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ì˜ˆì‹œ ì½”ë“œ: ê²°ê³¼ ë§¤í•‘ ì •ë³´ ì •ì˜</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@SqlResultSetMapping</span><span class="o">(</span>
	<span class="n">name</span> <span class="o">=</span> <span class="s">"memberWithOrderCount"</span><span class="o">,</span>
	<span class="n">entities</span> <span class="o">=</span> <span class="o">{</span><span class="nd">@EntityResult</span><span class="o">(</span><span class="n">entityClass</span> <span class="o">=</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span><span class="o">)},</span>
	<span class="n">columns</span> <span class="o">=</span> <span class="o">{</span><span class="nd">@ColumnResult</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ORDER_COUNT"</span><span class="o">)}</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
	<span class="c1">//...</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
<li>íšŒì› ì—”í‹°í‹° ë° <code>ORDER_COUNT</code> ì¹¼ëŸ¼ì„ ë§¤í•‘í–ˆë‹¤.
<ul>
<li><code>ID</code> , <code>AGE</code> , <code>NAME</code> , <code>TEAM_ID</code> ëŠ” Member ì—”í‹°í‹°ì™€ ë§¤í•‘ëœë‹¤.</li>
<li><code>ORDER_COUNT</code> ëŠ” ë‹¨ìˆœíˆ ê°’ìœ¼ë¡œ ë§¤í•‘ëœë‹¤.</li>
</ul>
</li>
</ul>
</li>
</ul>
<br/>
<h3 id="section-5">ê²°ê³¼ ë§¤í•‘ ì‚¬ìš© - 2</h3>
<p>JPA í‘œì¤€ ëª…ì„¸ì´ ìˆëŠ” ì˜ˆì œ ì½”ë“œë¡œ ê²°ê³¼ ë§¤í•‘ì„ ì–´ë–»ê²Œ í•˜ëŠ”ì§€ ì¢€ ë” ìì„¸íˆ ì•Œì•„ë³´ì.</p>
<ul>
<li>
<p>í‘œì¤€ ëª…ì„¸ ì˜ˆì œ - SQL</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Query</span> <span class="n">q</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="na">createNativeQuery</span><span class="o">(</span>
	<span class="s">"SELECT o.id AS order_id, "</span> <span class="o">+</span>
		<span class="s">"o.quantity AS order_quantity, "</span> <span class="o">+</span>
		<span class="s">"o.item AS order_item, "</span> <span class="o">+</span>
		<span class="s">"i.name AS item_name, "</span> <span class="o">+</span>
	<span class="s">"FROM Order o, Item i "</span> <span class="o">+</span>
	<span class="s">"WHERE (order_quantity &gt; 25) AND (order_item = i.id)"</span>
<span class="o">,</span> <span class="s">"OrderResults"</span><span class="o">);</span>
</code></pre></div></div>
</li>
<li>
<p>í‘œì¤€ ëª…ì„¸ ì˜ˆì œ - ë§¤í•‘ ì •ë³´</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SqlResultSetMapping</span><span class="o">(</span>
	<span class="n">name</span> <span class="o">=</span> <span class="s">"OrderResults"</span><span class="o">,</span>
	<span class="n">entities</span> <span class="o">=</span> <span class="o">{</span>
		<span class="nd">@EntityResult</span><span class="o">(</span><span class="n">entityClass</span> <span class="o">=</span> <span class="n">com</span><span class="o">.</span><span class="na">acme</span><span class="o">.</span><span class="na">Order</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">fields</span><span class="o">={</span>
			<span class="nd">@FieldResult</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"id"</span><span class="o">,</span> <span class="n">column</span><span class="o">=</span><span class="s">"order_id"</span><span class="o">),</span>
			<span class="nd">@FieldResult</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"quantity"</span><span class="o">,</span> <span class="n">column</span><span class="o">=</span><span class="s">"order_quantity"</span><span class="o">),</span>
			<span class="nd">@FieldResult</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"item"</span><span class="o">,</span> <span class="n">column</span><span class="o">=</span><span class="s">"order_item"</span><span class="o">)</span>
		<span class="o">})</span>
	<span class="o">},</span>
	<span class="n">columns</span> <span class="o">=</span> <span class="o">{</span>
		<span class="nd">@ColumnResult</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"item_name"</span><span class="o">)</span>
	<span class="o">}</span>
<span class="o">)</span>
</code></pre></div></div>
</li>
<li>
<p>ìƒì„¸ ì„¤ëª…</p>
<ul>
<li><code>@FieldResult</code>
<ul>
<li>í•´ë‹¹ ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ, ì¹¼ëŸ¼ëª…ê³¼ í•„ë“œëª…ì„ ì§ì ‘ ë§¤í•‘í•œë‹¤.</li>
<li>SQLì—ì„œ í”„ë¡œì ì…˜ì´ ì „ë¶€ ë³„ì¹­ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</li>
</ul>
</li>
<li><code>@FieldResult</code> ë¥¼ í•œë²ˆì´ë¼ë„ ì‚¬ìš©í•˜ë©´, ì „ì²´ í•„ë“œë¥¼ <code>@FieldResult</code>ë¡œ ë§¤í•‘í•´ì•¼ í•œë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li>
<p>ì•„ë˜ì²˜ëŸ¼ ë‘ ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ëŠ”ë° ì¹¼ëŸ¼ëª…ì´ ì¤‘ë³µë  ë•Œë„, <code>@FieldResult</code>ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">//</span> <span class="err">ì¹¼ëŸ¼ëª…</span> <span class="err">ì¶©ëŒì´</span> <span class="err">ì¼ì–´ë‚œë‹¤</span><span class="p">.</span>
<span class="k">SELECT</span> <span class="n">A</span><span class="p">.</span><span class="n">ID</span><span class="p">,</span> <span class="n">B</span><span class="p">.</span><span class="n">ID</span> <span class="k">FROM</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span>
<p><span class="o">//</span> <span class="err">ì¹¼ëŸ¼ëª…</span> <span class="err">ì¶©ëŒ</span> <span class="err">ë°©ì§€</span>
<span class="k">SELECT</span>
<span class="n">A</span><span class="p">.</span><span class="n">ID</span> <span class="k">AS</span> <span class="n">A_ID</span><span class="p">,</span>
<span class="n">B</span><span class="p">.</span><span class="n">ID</span> <span class="k">AS</span> <span class="n">B_ID</span>
<span class="k">FROM</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span>
</code></pre></div></div></p>
<ul>
<li>ì´ê²ƒì„ <code>@FieldResult</code> ìœ¼ë¡œ ë§¤í•‘í•´ì•¼ í•œë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<h3 id="section-6">ê²°ê³¼ ë§¤í•‘ ì• ë„ˆí…Œì´ì…˜</h3>
<ul>
<li><code>@SqlResultSetMapping</code> ì†ì„±</li>
</ul>
<table>
<thead>
<tr>
<th>ì†ì„±</th>
<th>ê¸°ëŠ¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>ê²°ê³¼ ë§¤í•‘ ì´ë¦„</td>
</tr>
<tr>
<td>entities</td>
<td>@EntityResult ë¥¼ ì‚¬ìš©í•´ì„œ ì—”í‹°í‹°ë¥¼ ê²°ê³¼ë¡œ ë§¤í•‘í•œë‹¤.</td>
</tr>
<tr>
<td>columns</td>
<td>@ColumnResult ë¥¼ ì‚¬ìš©í•´ì„œ ì¹¼ëŸ¼ì„ ê²°ê³¼ë¡œ ë§¤í•‘í•œë‹¤.</td>
</tr>
</tbody>
</table>
<br/>
<ul>
<li><code>@EntityResult</code> ì†ì„±</li>
</ul>
<table>
<thead>
<tr>
<th>ì†ì„±</th>
<th>ê¸°ëŠ¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>entityClass</td>
<td>ê²°ê³¼ë¡œ ì‚¬ìš©í•  ì—”í‹°í‹° í´ë˜ìŠ¤ë¥¼ ì§€ì •í•œë‹¤.</td>
</tr>
<tr>
<td>fields</td>
<td>@FieldResult ë¥¼ ì‚¬ìš©í•´ì„œ ê²°ê³¼ ì¹¼ëŸ¼ì„ í•„ë“œì™€ ë§¤í•‘í•œë‹¤.</td>
</tr>
<tr>
<td>discriminatorColumn</td>
<td>ì—”í‹°í‹°ì˜ ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ì„ êµ¬ë¶„í•˜ëŠ” í•„ë“œ (ìƒì†ì—ì„œ ì‚¬ìš©ëœë‹¤.)</td>
</tr>
</tbody>
</table>
<br/>
<ul>
<li><code>@FieldResult</code> ì†ì„±</li>
</ul>
<table>
<thead>
<tr>
<th>ì†ì„±</th>
<th>ê¸°ëŠ¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>ê²°ê³¼ë¥¼ ë°›ì„ í•„ë“œëª…</td>
</tr>
<tr>
<td>column</td>
<td>ê²°ê³¼ ì¹¼ëŸ¼ëª…</td>
</tr>
</tbody>
</table>
<br/>
<ul>
<li><code>@ColumnResult</code> ì†ì„±</li>
</ul>
<table>
<thead>
<tr>
<th>ì†ì„±</th>
<th>ê¸°ëŠ¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>ê²°ê³¼ ì¹¼ëŸ¼ëª…</td>
</tr>
</tbody>
</table>
<p><br/><br/></p>
<h2 id="named--sql">Named ë„¤ì´í‹°ë¸Œ SQL</h2>
<h3 id="section-7">ì—”í‹°í‹° ì¡°íšŒ ì˜ˆì‹œ ì½”ë“œ</h3>
<ul>
<li>
<p>Named ë„¤ì´í‹°ë¸Œ SQL ì •ì˜</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@NamedNativeQuery</span><span class="o">(</span>
	<span class="n">name</span> <span class="o">=</span> <span class="s">"Member.memberSQL"</span><span class="o">,</span>
	<span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT ID, AGE, NAME, TEAM_ID "</span> <span class="o">+</span>
		<span class="s">"FROM MEMBER WHERE AGE &gt; ?"</span><span class="o">,</span>
	<span class="n">resultClass</span> <span class="o">=</span> <span class="nc">Member</span><span class="o">.</span><span class="na">class</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{...}</span>
</code></pre></div></div>
</li>
<li>
<p>Named ë„¤ì´í‹°ë¸Œ SQL ì‚¬ìš©</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">TypedQuery</span><span class="o">&lt;</span><span class="nc">Member</span><span class="o">&gt;</span> <span class="n">nativeQuery</span> <span class="o">=</span>
		<span class="n">em</span><span class="o">.</span><span class="na">createNamedeQuery</span><span class="o">(</span><span class="s">"Member.memberSQL"</span><span class="o">,</span> <span class="n">member</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
		<span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span>
</code></pre></div></div>
</li>
<li>
<p>ìƒì„¸ ì„¤ëª…</p>
<ul>
<li>JPQL Named ì¿¼ë¦¬ì™€ ê°™ì€ <code>createNamedQuery()</code> ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬, ë„¤ì´í‹°ë¸Œ Named ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤.</li>
<li>ì°¨ì´ì ì€ ì˜¤ì§ <code>@NamedNativeQuery</code> â†” <code>@NamedQuery</code> ë°–ì— ì—†ë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li>
<p>ê²°ê³¼ ë§¤í•‘ì„ ì‚¬ìš©í•˜ëŠ” Named ë„¤ì´í‹°ë¸Œ SQL ì •ì˜</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@NamedNativeQuery</span><span class="o">(</span>
	<span class="n">name</span> <span class="o">=</span> <span class="s">"Member.memberWithOrderCount"</span><span class="o">,</span>
	<span class="n">query</span> <span class="o">=</span> <span class="s">"SELECT M.ID, AGE, NAME, TEAM_ID, I.ORDER_COUNT "</span> <span class="o">+</span>
		<span class="s">"FROM MEMBER "</span> <span class="o">+</span>
		<span class="s">"LEFT JOIN "</span> <span class="o">+</span>
			<span class="s">"(SELECT IM.ID, COUNT(*) AS ORDER_COUNT "</span> <span class="o">+</span>
			<span class="s">"FROM ORDERS O, MEMBER IM "</span> <span class="o">+</span>
			<span class="s">"WHERE O.MEMBER_ID = IM.ID) I"</span> <span class="o">+</span>
		<span class="s">"ON M.ID = I.ID"</span><span class="o">,</span>
	<span class="n">resultSetMapping</span> <span class="o">=</span> <span class="s">"memberWithOrderCount"</span> <span class="c1">//í•´ë‹¹ ê²°ê³¼ ë§¤í•‘ ì‚¬ìš©</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{...}</span>
</code></pre></div></div>
<ul>
<li><code>resultSetMapping = &quot;memberWithOrderCount&quot;</code>
<ul>
<li>í•´ë‹¹ ì†ì„±ì„ í†µí•´, <code>memberWithOrderCount</code> ê²°ê³¼ ë§¤í•‘ì„ ì‚¬ìš©í•œë‹¤.</li>
</ul>
</li>
</ul>
</li>
</ul>
<br/>
<h3 id="namednativequery-">NamedNativeQuery ì†ì„±</h3>
<table>
<thead>
<tr>
<th>ì†ì„±</th>
<th>ê¸°ëŠ¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>ë„¤ì„ë“œ ì¿¼ë¦¬ ì´ë¦„ (í•„ìˆ˜)</td>
</tr>
<tr>
<td>query</td>
<td>SQL ì¿¼ë¦¬ (í•„ìˆ˜)</td>
</tr>
<tr>
<td>hints</td>
<td>ë²¤ë” ì¢…ì†ì ì¸ íŒíŠ¸</td>
</tr>
<tr>
<td>resultClass</td>
<td>ê²°ê³¼ í´ë˜ìŠ¤</td>
</tr>
<tr>
<td>resultSetMapping</td>
<td>ê²°ê³¼ ë§¤í•‘ ì‚¬ìš©</td>
</tr>
</tbody>
</table>
<br/>
<h3 id="named---">ì—¬ëŸ¬ Named ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬ ì„ ì–¸</h3>
<p>ì—¬ëŸ¬ Named ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬ë¥¼ ì„ ì–¸í•˜ë ¤ë©´ ì•„ë˜ì²˜ëŸ¼ <code>@NamedNativeQueries</code> ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@NamedNativeQueries</span><span class="o">({</span>
	<span class="nd">@NamedNativeQuery</span><span class="o">(...),</span>
	<span class="nd">@NamedNativeQuery</span><span class="o">(...)</span>
<span class="o">)</span>
</code></pre></div></div>
<p><br/><br/></p>
<h2 id="sql-xml-">ë„¤ì´í‹°ë¸Œ SQLë¥¼ XMLì— ì •ì˜í•˜ê¸°</h2>
<h3 id="section-8">ì˜ˆì‹œ ì½”ë“œ</h3>
<ul>
<li>
<p>ormMember.xml</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;entity-mappings</span> <span class="err">...</span><span class="nt">&gt;</span>
<pre><code>&lt;span class=&quot;nt&quot;&gt;&amp;lt;named-native-query&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Member.memberWithOrderCountXml&quot;&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;result-set-mapping=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;memberWithOrderCountResultMap&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;query&amp;gt;&amp;lt;CDATA&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;[&lt;/span&gt;
		&lt;span class=&quot;err&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;M.ID,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;AGE,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;NAME,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;TEAM_ID,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;I.ORDER_COUNT&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;MEMBER&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;M&lt;/span&gt;
		&lt;span class=&quot;err&quot;&gt;LEFT&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;JOIN&lt;/span&gt;
			&lt;span class=&quot;err&quot;&gt;(SELECT&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;IM.ID,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;COUNT(*)&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;ORDER_COUNT&lt;/span&gt;
			&lt;span class=&quot;err&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;ORDERS&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;O,&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;MEMBER&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;IM&lt;/span&gt;
			&lt;span class=&quot;err&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;O.MEMBER_ID =&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;IM.ID)&lt;/span&gt;
		&lt;span class=&quot;err&quot;&gt;ON&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;M.ID =&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;I.ID&lt;/span&gt;
	&lt;span class=&quot;err&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/query&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/named-native-query&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;sql-result-set-mapping&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;memberWithOrderCountResultMap&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;entity-result&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;entity-class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;jpabook.domain.Member&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;column-result&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ORDER_COUNT&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/sql-result-set-mapping&amp;gt;&lt;/span&gt;
</code></pre>
<p><span class="nt">&lt;/entity-mappings&gt;</span>
</code></pre></div></div></p>
</li>
<li>
<p>ìƒì„¸ì„¤ëª…</p>
<ul>
<li>XMLì— ì •ì˜í•  ë•ŒëŠ” ìˆœì„œë¥¼ ì§€ì¼œì•¼ í•œë‹¤. ìˆœì„œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.
<ol>
<li><code>&lt;named-native-query&gt;</code> ì •ì˜</li>
<li><code>&lt;sql-result-set-mapping&gt;</code> ì •ì˜</li>
</ol>
</li>
</ul>
<blockquote>
<p>ì• ë„ˆí…Œì´ì…˜ ë³´ë‹¤ëŠ” xmlì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” í¸ë¦¬í•˜ë‹¤.</p>
</blockquote>
</li>
</ul>
<br/>
<h3 id="sql--1">ë„¤ì´í‹°ë¸Œ SQL ì •ë¦¬</h3>
<ul>
<li>ë„¤ì´í‹°ë¸Œ SQLë„ JPQLì„ ì‚¬ìš©í•  ë•Œì™€ ë§ˆì°¬ê°€ì§€ë¡œ <code>Query</code> , <code>TypedQuery</code> ë¥¼ ë°˜í™˜í•œë‹¤.
<ul>
<li>ë”°ë¼ì„œ JPQL APIë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
<li>ë„¤ì´í‹°ë¸Œ SQLì€ JPQLì´ ìë™ ìƒì„±í•˜ëŠ” SQLì„ ìˆ˜ë™ì„ ì§ì ‘ ì •ì˜í•˜ëŠ” ê²ƒì´ë‹¤.
<ul>
<li>ë”°ë¼ì„œ JPAê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ ëŒ€ë¶€ë¶„ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li>ê¶Œì¥ ë°©ì‹
<ul>
<li>ë  ìˆ˜ ìˆìœ¼ë©´ í‘œì¤€ JPQLì„ ì‚¬ìš©í•˜ë¼.</li>
<li>ê¸°ëŠ¥ì´ ë¶€ì¡±í•˜ë©´ í•˜ì´ë²„ë„¤ì´íŠ¸ì™€ ê°™ì€ JPA êµ¬í˜„ì²´ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë¼.</li>
<li>ê·¸ë˜ë„ ì•ˆëœë‹¤ë©´, ë§ˆì§€ë§‰ ë°©ë²•ìœ¼ë¡œ ë„¤ì´í‹°ë¸Œ SQLì„ ì‚¬ìš©í•˜ì.</li>
</ul>
</li>
</ul>
<p><br/><br/></p>
<h2 id="jpa-21">ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì €(JPA 2.1)</h2>
<h3 id="section-9">ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì €ë€?</h3>
<ul>
<li>ì—¬ëŸ¬ ì¿¼ë¦¬ë¥¼ í•˜ë‚˜ì˜ í•¨ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤. ì´ê²ƒì€ DBì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.</li>
</ul>
<br/>
<h3 id="section-10">ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì € ì‚¬ìš©</h3>
<ul>
<li>
<p>MySQL DBì— ì„ ì–¸ëœ í”„ë¡œì‹œì €</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DELIMITER</span> <span class="o">//</span>
<p><span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="n">proc_multiply</span> <span class="p">(</span><span class="k">INOUT</span> <span class="n">inParam</span> <span class="nb">INT</span><span class="p">,</span> <span class="k">INOUT</span> <span class="n">outParam</span> <span class="nb">INT</span><span class="p">)</span>
<span class="k">BEGIN</span>
<span class="k">SET</span> <span class="n">outParam</span> <span class="o">=</span> <span class="n">inParam</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="k">END</span> <span class="o">//</span>
</code></pre></div></div></p>
<ul>
<li>ë§¤ê°œë³€ìˆ˜ (ìì„¸í•œ ê²ƒì€ DB ê´€ë ¨ ìë£Œë¥¼ ì°¾ì•„ë³´ì.)
<ul>
<li><code>IN</code>
<ul>
<li>í˜¸ì¶œìì—ê²Œ ì „ë‹¬ë°›ì€ ê°’ì„ ë³µì‚¬í•´ì„œ, í”„ë¡œì‹œì € ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©í•œë‹¤.</li>
<li><strong>í”„ë¡œì‹œì € ë‚´ë¶€ ê°’ ì „ë‹¬ O, ê°’ ë°˜í™˜ X</strong></li>
</ul>
</li>
<li><code>OUT</code>
<ul>
<li>ê°’ì„ ì „ë‹¬ë°›ì§€ëŠ” ì•Šê³ , í”„ë¡œì‹œì € ë‚´ë¶€ì—ì„œì˜ ìµœì¢…ê°’ì„ í˜¸ì¶œìì—ê²Œ ì „ë‹¬í•œë‹¤.</li>
<li>ì´ˆê¸°ê°’=NULL</li>
<li><strong>í”„ë¡œì‹œì € ë‚´ë¶€ ê°’ ì „ë‹¬ X, ê°’ ë°˜í™˜ O</strong></li>
</ul>
</li>
<li><code>INOUT</code>
<ul>
<li><code>IN</code> + <code>OUT</code></li>
<li><strong>í”„ë¡œì‹œì € ë‚´ë¶€ ê°’ ì „ë‹¬ O, ê°’ ë°˜í™˜ O</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li>
<p>JPAë¥¼ í†µí•´, ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì € í˜¸ì¶œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ì‚¬ìš©í•  í”„ë¡œì‹œì € ê°ì²´ ìƒì„±</span>
<span class="nc">StoredProcedureQuery</span> <span class="n">spq</span> <span class="o">=</span>
	<span class="n">em</span><span class="o">.</span><span class="na">createStoredProcedureQuery</span><span class="o">(</span><span class="s">"proc_multiply"</span><span class="o">);</span> <span class="c1">//ì •ì˜ëœ í”„ë¡œì‹œì €ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.</span>
<p><span class="c1">//ì²«ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ ì •ì˜</span>
<span class="n">spq</span><span class="o">.</span><span class="na">registerStoredProcedureParameter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">ParameterMode</span><span class="o">.</span><span class="na">IN</span><span class="o">);</span></p>
<p><span class="c1">//ë‘ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ ì •ì˜</span>
<span class="n">spq</span><span class="o">.</span><span class="na">registerStoredProcedureParameter</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">ParameterMode</span><span class="o">.</span><span class="na">OUT</span><span class="o">);</span></p>
<p><span class="c1">//ì²«ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì— 100 ì „ë‹¬</span>
<span class="n">spq</span><span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">);</span></p>
<p><span class="c1">//í”„ë¡œì‹œì € ì‹¤í–‰</span>
<span class="n">spq</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span></p>
<p><span class="c1">//Output íŒŒë¼ë¯¸í„°ì¸ 2ë²ˆ íŒŒë¼ë¯¸í„° ê°’ í™•ì¸</span>
<span class="nc">Integer</span> <span class="n">out</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Integer</span><span class="o">)</span> <span class="n">spq</span><span class="o">.</span><span class="na">getOutputParameterValue</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span></p>
<p><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">â€œout = â€œ</span> <span class="o">+</span> <span class="n">out</span><span class="o">);</span>
<span class="c1">//ê²°ê³¼: out = 200</span>
</code></pre></div></div></p>
</li>
<li>
<p>ìƒì„¸ ì„¤ëª…</p>
<ul>
<li><code>em.createStoredProcedureQuery()</code> ë©”ì„œë“œ
<ul>
<li>íŒŒë¼ë¯¸í„°ì— ì‚¬ìš©í•  ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì € ì´ë¦„ì„ ë„˜ê²¨ì¤˜ì•¼ í•œë‹¤.</li>
</ul>
</li>
<li><code>registerStoredProcedureParameter()</code> ë©”ì„œë“œ
<ul>
<li>
<p>í”„ë¡œì‹œì €ì— ì‚¬ìš©í•  íŒŒë¼ë¯¸í„°ë¥¼ ì•„ë˜ì™€ ê°™ì€ ìˆœì„œë¡œ ì •ì˜í•œë‹¤.</p>
<ol>
<li>ìˆœì„œ</li>
<li>íƒ€ì…</li>
<li>íŒŒë¼ë¯¸í„° ëª¨ë“œ</li>
</ol>
</li>
<li>
<p>íŒŒë¼ë¯¸í„° ëª¨ë“œ ì¢…ë¥˜</p>
<ul>
<li><code>IN</code> , <code>INOUT</code> , <code>OUT</code> , <code>REF_CURSOR</code></li>
</ul>
</li>
<li>
<p>íŒŒë¼ë¯¸í„°ì— ìˆœì„œ ëŒ€ì‹  ì´ë¦„ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">spq</span><span class="o">.</span><span class="na">setparameter</span><span class="o">(</span><span class="s">"inParam"</span><span class="o">,</span> <span class="mi">100</span><span class="o">);</span>
<span class="n">spq</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
</code></pre></div></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<br/>
<h3 id="named----1">Named ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì € ì‚¬ìš©</h3>
<ul>
<li>
<p>ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì € ì¿¼ë¦¬ì— ì•„ë˜ì™€ ê°™ì´ ì´ë¦„ì„ ë¶€ì—¬í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ <strong>Named ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì €</strong>ë¼ê³  í•œë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@NamedStoredProcedureQuery</span><span class="o">(</span>
	<span class="n">name</span> <span class="o">=</span> <span class="s">"multiply"</span><span class="o">,</span>
	<span class="n">procedureName</span> <span class="o">=</span> <span class="s">"proc_multiply"</span><span class="o">,</span>
	<span class="n">parameters</span> <span class="o">=</span> <span class="o">{</span>
		<span class="nd">@StoredProcedureParameter</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"inParam"</span><span class="o">,</span>
			<span class="n">mode</span> <span class="o">=</span> <span class="nc">ParameterMode</span><span class="o">.</span><span class="na">IN</span><span class="o">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
		<span class="nd">@StoredProcedureParameter</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"outParam"</span><span class="o">,</span>
			<span class="n">mode</span> <span class="o">=</span> <span class="nc">ParameterMode</span><span class="o">.</span><span class="na">OUT</span><span class="o">,</span> <span class="n">type</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">),</span>
	<span class="o">}</span>
<span class="o">)</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Member</span> <span class="o">{...}</span>
</code></pre></div></div>
</li>
<li>
<p>Named ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì € ì‚¬ìš©ë°©ë²•</p>
<ol>
<li><code>@NamedStoredProcedureQuery</code> ë¡œ ì‚¬ìš©í•  í”„ë¡œì‹œì €ë¥¼ ì •ì˜í•œë‹¤.</li>
<li><code>name</code> ì†ì„±ìœ¼ë¡œ ì´ë¦„ì„ ë¶€ì—¬í•œë‹¤.</li>
<li><code>procedureName</code> ì†ì„±ì— ì‹¤ì œ í˜¸ì¶œí•  í”„ë¡œì‹œì € ì´ë¦„ì„ ì‘ì„±í•œë‹¤.</li>
<li><code>@StoredProcedureParameter</code> ë¥¼ ì‚¬ìš©í•´ì„œ íŒŒë¼ë¯¸í„° ì •ë³´ë¥¼ ì €ìœ¼ì´í•œë‹¤.</li>
</ol>
<blockquote>
<p>ë‘˜ ì´ìƒì„ ì •ì˜í•˜ë ¤ë©´ <code>@NamedStoredProcedureQueries</code> ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p>
</blockquote>
</li>
</ul>
<br/>
<h3 id="named---xml-">Named ìŠ¤í† ì–´ë“œ í”„ë¡œì‹œì € XMLì— ì •ì˜í•˜ê¸°</h3>
<ul>
<li>
<p>xml ì •ì˜</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;entity-mappings</span> <span class="na">xmlns=</span><span class="s">"http://xmlns.jcp.org/xml/ns/persistence/orm"</span> <span class="na">version=</span><span class="s">"2.1"</span><span class="nt">&gt;</span>
<pre><code>&lt;span class=&quot;nt&quot;&gt;&amp;lt;named-stored-procedure-query&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;multiply&quot;&lt;/span&gt;
	&lt;span class=&quot;na&quot;&gt;procedure-name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;proc_multiply&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;parameter&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;inParam&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;mode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;IN&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;java.lang.Integer&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;parameter&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;outParam&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;mode=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;OUT&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;java.lang.Integer&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/named-stored-procedure-query&amp;gt;&lt;/span&gt;
</code></pre>
<p><span class="nt">&lt;/entity-mappings&gt;</span>
</code></pre></div></div></p>
</li>
<li>
<p>ì‚¬ìš©í•˜ê¸°</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//xmlì— ì •ì˜í•œ í”„ë¡œì‹œì € ìƒì„±</span>
<span class="nc">StoredProcedureQuery</span> <span class="n">spq</span> <span class="o">=</span>
	<span class="n">em</span><span class="o">.</span><span class="na">createNamedStoredProcedureQuery</span><span class="o">(</span><span class="s">"multiply"</span><span class="o">);</span>
<p><span class="c1">//ë§¤ê°œë³€ìˆ˜ì— ê°’ ì „ë‹¬</span>
<span class="n">spq</span><span class="o">.</span><span class="na">setParameter</span><span class="o">(</span><span class="s">â€œinParamâ€</span><span class="o">,</span> <span class="mi">100</span><span class="o">);</span></p>
<p><span class="c1">//ì‹¤í–‰</span>
<span class="n">spq</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span></p>
<p><span class="nc">Integer</span> <span class="n">out</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Integer</span><span class="o">)</span> <span class="n">spq</span><span class="o">.</span><span class="na">getOutputParameterValue</span><span class="o">(</span><span class="s">â€œoutParamâ€</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">â€œout = â€œ</span> <span class="o">+</span> <span class="n">out</span><span class="o">);</span>
</code></pre></div></div></p>
</li>
</ul>
<p><br><br></p>
<hr />
<br>
<div style="font-style: italic;color: gray;">
  <ul>
    <li>ê¹€ì˜í•œ, ã€ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°ã€, ì—ì´ì½˜</li>
  </ul>
  ë³¸ ê²Œì‹œê¸€ì€ ìœ„ êµì¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤.
</div>
:ET