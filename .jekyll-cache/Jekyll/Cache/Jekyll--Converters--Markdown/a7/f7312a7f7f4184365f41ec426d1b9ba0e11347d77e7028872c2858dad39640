I"àu<p><br/><br/></p>
<h1 id="section">íŒŒì¼ ì—…ë¡œë“œ</h1>
<h2 id="section-1">ê°œìš”</h2>
<ul>
<li>HTML Formì„ í†µí•´ íŒŒì¼ ì—…ë¡œë“œë¥¼ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ì.</li>
<li>ê·¸ ì „ì—, í¼ ì „ì†¡ì˜ ë°©ì‹ì— ëŒ€í•´ ì´í•´í•˜ê³  ë„˜ì–´ê°€ì.</li>
</ul>
<p><br/><br/></p>
<h2 id="html---">HTML í¼ ì „ì†¡ ë°©ì‹</h2>
<h3 id="section-2">ì „ì†¡ ë°©ì‹ì˜ ì¢…ë¥˜</h3>
<ul>
<li><code>application/x-www-form-urlencoded</code></li>
<li><code>multipart/form-data</code></li>
</ul>
<br/>
<h3 id="codeapplicationx-www-form-urlencodedcode-"><code>application/x-www-form-urlencoded</code> ë°©ì‹</h3>
<p><img src="/assets/img/2021-08-18-SPRING_MVC_UploadAndDownload/Untitled%2037.png" alt="Untitled" /></p>
<ul>
<li>HTML í¼ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ë²•ì´ë‹¤.</li>
<li>Form íƒœê·¸ì— ë³„ë„ì˜ <code>enctype</code> ì˜µì…˜ì´ ì—†ìœ¼ë©´, ì›¹ ë¸Œë¼ìš°ì €ëŠ” ìš”ì²­ HTTP ë©”ì‹œì§€ì˜ í—¤ë”ì— ì•„ë˜ ë‚´ìš©ì„ ì¶”ê°€í•œë‹¤.
<ul>
<li><code>Content-Type: application/x-www-form-urlencoded</code></li>
</ul>
</li>
<li>ì´ ë°©ì‹ì€ ë¬¸ìë¥¼ ì„œë²„ì— ì „ì†¡í•˜ëŠ” ë°©ì‹ì´ë‹¤.</li>
</ul>
<br/>
<h3 id="codemultipartform-datacode-"><code>multipart/form-data</code> ë°©ì‹</h3>
<p><img src="/assets/img/2021-08-18-SPRING_MVC_UploadAndDownload/Untitled%2038.png" alt="Untitled" /></p>
<ul>
<li>
<p>ì´ ë°©ì‹ì„ ì‚¬ìš©í•˜ë ¤ë©´ Form íƒœê·¸ì— <code>enctype=&quot;multipart/form-data&quot;</code> ë¥¼ ì§€ì •í•´ì•¼ í•œë‹¤.</p>
</li>
<li>
<p><strong>ë‹¤ë¥¸ ì¢…ë¥˜ì˜ ì—¬ëŸ¬ íŒŒì¼ê³¼ í¼ì˜ ë‚´ìš©ì„ í•¨ê»˜ ì „ì†¡í•  ìˆ˜ ìˆë‹¤.</strong></p>
<blockquote>
<p>ê·¸ë˜ì„œ ì´ë¦„ì´ <code>multipart</code> ì´ë‹¤.</p>
</blockquote>
</li>
<li>
<p><strong>ì „ì†¡ í•­ëª© êµ¬ë¶„ì</strong></p>
<ul>
<li><code>------XXX</code></li>
</ul>
</li>
<li>
<p><strong>í¼ ë°ì´í„° ì¢…ë¥˜</strong></p>
<ul>
<li><strong>í¼ ì¼ë°˜ ë°ì´í„°</strong>
<ul>
<li>name (í•­ëª©ì†ì„±)</li>
<li>ë¬¸ì</li>
</ul>
</li>
<li><strong>íŒŒì¼ ë°ì´í„°</strong>
<ul>
<li>name (í•­ëª©ì†ì„±)</li>
<li>íŒŒì¼ ì´ë¦„</li>
<li>Content-Type</li>
<li>ë°”ì´ë„ˆë¦¬ ë°ì´í„°</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><br/><br/></p>
<h2 id="section-3">ì„œë¸”ë¦¿ ì—…ë¡œë“œ ì˜ˆì‹œ</h2>
<ul>
<li>ë¨¼ì € ì„œë¸”ë¦¿ì„ í†µí•´, ì—…ë¡œë“œ ë¡œì§ì„ ì²˜ë¦¬í•´ë³´ì.</li>
</ul>
<br/>
<h3 id="codeapplicationpropertiescode-">ì—…ë¡œë“œ ê²½ë¡œ ì„¤ì •: <code>application.properties</code> íŒŒì¼</h3>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file.dir=D:\\Spring\\fileDir\\
</code></pre></div></div>
<ul>
<li><strong>ë°˜ë“œì‹œ ì„¤ì •í•œ ê²½ë¡œì— ì‹¤ì œ í´ë”ë¥¼ ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘ì.</strong></li>
<li><strong>ê²½ë¡œ ë§ˆì§€ë§‰ì— \(ìŠ¬ë˜ì‹œ)ê°€ ë¶™ì€ ê²ƒì— ì£¼ì˜í•˜ì.</strong></li>
</ul>
<br/>
<h3 id="codeservletuploadcontrollercode-">ì—…ë¡œë“œ ì²˜ë¦¬ ì»¨íŠ¸ë¡¤ëŸ¬: <code>ServletUploadController</code> í´ë˜ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.extern.slf4j.Slf4j</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Value</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.util.StreamUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.util.StringUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PostMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.ServletException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.Part</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>

<span class="nd">@Slf4j</span>
<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/servlet"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ServletUploadController</span> <span class="o">{</span>
    
  <span class="nd">@Value</span><span class="o">(</span><span class="s">"${file.dir}"</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">fileDir</span><span class="o">;</span>

  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/upload"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">newFile</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"upload-form"</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/upload"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">saveFile</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">itemName</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">"itemName"</span><span class="o">);</span>
    <span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">Part</span><span class="o">&gt;</span> <span class="n">parts</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getParts</span><span class="o">();</span>

    <span class="k">for</span> <span class="o">(</span><span class="nc">Part</span> <span class="n">part</span> <span class="o">:</span> <span class="n">parts</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"==== Part ===="</span><span class="o">);</span>
      <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"name = {}"</span><span class="o">,</span> <span class="n">part</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
      <span class="nc">Collection</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">headerNames</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="na">getHeaderNames</span><span class="o">();</span>
      
			<span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">headerName</span> <span class="o">:</span> <span class="n">headerNames</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"header {}: {}"</span><span class="o">,</span> <span class="n">headerName</span><span class="o">,</span> <span class="n">part</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="n">headerName</span><span class="o">));</span>
      <span class="o">}</span>

      <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"submittedFileName = {}"</span><span class="o">,</span> <span class="n">part</span><span class="o">.</span><span class="na">getSubmittedFileName</span><span class="o">());</span>
      <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"size = {}"</span><span class="o">,</span> <span class="n">part</span><span class="o">.</span><span class="na">getSize</span><span class="o">());</span>
        
      <span class="c1">//--------- ë°ì´í„° ì½ê¸° ------------</span>
      <span class="nc">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">part</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
      <span class="nc">String</span> <span class="n">body</span> <span class="o">=</span> <span class="nc">StreamUtils</span><span class="o">.</span><span class="na">copyToString</span><span class="o">(</span><span class="n">inputStream</span><span class="o">,</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
      <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"body = {}"</span><span class="o">,</span> <span class="n">body</span><span class="o">);</span>
        
      <span class="c1">//-------- íŒŒì¼ ì €ì¥í•˜ê¸° ------------</span>
      <span class="k">if</span> <span class="o">(</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">hasText</span><span class="o">(</span><span class="n">part</span><span class="o">.</span><span class="na">getSubmittedFileName</span><span class="o">()))</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">fulPath</span> <span class="o">=</span> <span class="n">fileDir</span> <span class="o">+</span> <span class="n">part</span><span class="o">.</span><span class="na">getSubmittedFileName</span><span class="o">();</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"íŒŒì¼ ì €ì¥ fullPath = {}"</span><span class="o">,</span> <span class="n">fulPath</span><span class="o">);</span>
        <span class="n">part</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fulPath</span><span class="o">);</span>
      <span class="o">}</span>
        
    <span class="o">}</span>

    <span class="k">return</span> <span class="s">"upload-form"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
<li><strong>ë©€í‹°íŒŒíŠ¸ í˜•ì‹ì€ ì „ì†¡ ë°ì´í„°ë¥¼ í•˜ë‚˜í•˜ë‚˜ ê°ê° ë¶€ë¶„(<code>Part</code>)ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì „ì†¡í•œë‹¤.</strong>
<ul>
<li><code>Collection&lt;Part&gt; parts</code> ì—ëŠ” ì´ë ‡ê²Œ ë‚˜ëˆ„ì–´ì§„ ë°ì´í„°ê°€ ê°ê° ë‹´ê¸´ë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li><code>@Value(&quot;${file.dir}&quot;) private String fileDir;</code>
<ul>
<li><code>application.properties</code> ì—ì„œ ì„¤ì •í•œ <code>file.dir</code> ì˜ ê°’ì„ ì£¼ì…í•œë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li><strong>Part ê°ì²´ì˜ ì£¼ìš” ë©”ì„œë“œ</strong>
<ul>
<li><strong><code>part.getSubmittedFileName()</code></strong>
<ul>
<li>í´ë¼ì´ì–¸íŠ¸ê°€ ì „ë‹¬í•œ íŒŒì¼ëª…</li>
</ul>
</li>
<li><strong><code>part.getInputStream()</code></strong>
<ul>
<li>Partì˜ ì „ì†¡ ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
<li><strong><code>part.getWrite(...)</code></strong>
<ul>
<li>Partë¥¼ í†µí•´ ì „ì†¡ëœ ë°ì´í„°ë¥¼ ì €ì¥í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
</ul>
</li>
</ul>
<br/>
<h3 id="codeupload-formhtmlcode">í¼ ë·° í…œí”Œë¦¿: <code>upload-form.html</code></h3>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns:th=</span><span class="s">"http://www.thymeleaf.org"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Title<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"py-5 text-center"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;h2&gt;</span>ìƒí’ˆ ë“±ë¡ í¼<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;h4</span> <span class="na">class=</span><span class="s">"mb-3"</span><span class="nt">&gt;</span>ìƒí’ˆ ì…ë ¥<span class="nt">&lt;/h4&gt;</span>

    <span class="nt">&lt;form</span> <span class="na">th:action</span> <span class="na">method=</span><span class="s">"post"</span> <span class="na">enctype=</span><span class="s">"multipart/form-data"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ul&gt;</span>
            <span class="nt">&lt;li&gt;</span>ìƒí’ˆëª… <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"itemName"</span><span class="nt">&gt;&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>íŒŒì¼ <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"file"</span> <span class="na">name=</span><span class="s">"file"</span><span class="nt">&gt;&lt;/li&gt;</span>
        <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;/div&gt;</span> <span class="c">&lt;!-- /container --&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>
<br/>
<h3 id="section-4">ì—…ë¡œë“œ ê²°ê³¼</h3>
<ul>
<li>
<p><strong>ìš”ì²­</strong></p>
<p><img src="/assets/img/2021-08-18-SPRING_MVC_UploadAndDownload/Untitled%2039.png" alt="Untitled" /></p>
</li>
<li>
<p><strong>ê²°ê³¼</strong></p>
<p><img src="/assets/img/2021-08-18-SPRING_MVC_UploadAndDownload/Untitled%2040.png" alt="Untitled" /></p>
</li>
<li>
<p><strong>ë¡œê·¸</strong></p>
<p><img src="/assets/img/2021-08-18-SPRING_MVC_UploadAndDownload/Untitled%2041.png" alt="Untitled" /></p>
<p>ì´í•˜ ìƒëµ..</p>
</li>
</ul>
<p><br/><br/></p>
<h2 id="section-5">ì„¤ì •</h2>
<h3 id="section-6">ì—…ë¡œë“œ ì‚¬ì´ì¦ˆ ì œí•œ</h3>
<ul>
<li>
<p><code>application.properties</code> íŒŒì¼ì„ í†µí•´, ì—…ë¡œë“œ ì‚¬ì´ì¦ˆ ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤.</p>
</li>
<li>
<p><strong><code>spring.servlet.multipart.max-file-size</code></strong></p>
<ul>
<li>íŒŒì¼ í•˜ë‚˜ì˜ ìµœëŒ€ ì‚¬ì´ì¦ˆ</li>
<li>ê¸°ë³¸ 1MB</li>
</ul>
</li>
<li>
<p><strong><code>spring.servlet.multipart.max-request-size</code></strong></p>
<ul>
<li>ë©€í‹°íŒŒíŠ¸ ìš”ì²­ í•˜ë‚˜ì— ì—¬ëŸ¬ íŒŒì¼ì„ ì—…ë¡œë“œ í•  ìˆ˜ ìˆëŠ”ë°, ê·¸ ì „ì²´ í•© ì‚¬ì´ì¦ˆ</li>
<li>ê¸°ë³¸ 10MB</li>
</ul>
</li>
<li>
<p>ì˜ˆì‹œ</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#íŒŒì¼ í•œ ê°œë‹¹ ìµœëŒ€ ì‚¬ì´ì¦ˆ ì„¤ì •
spring.servlet.multipart.max-file-size=1MB

#ì—¬ëŸ¬ íŒŒì¼ì˜ ì´ ì‚¬ì´ì¦ˆ ì„¤ì •
spring.servlet.multipart.max-request-size=10MB
</code></pre></div></div>
</li>
</ul>
<br/>
<h3 id="section-7">ë©€í‹°íŒŒíŠ¸ ì²˜ë¦¬ ë„ê¸°</h3>
<ul>
<li>
<p><code>application.properties</code> íŒŒì¼ì„ í†µí•´, ì„œë²„ì—ì„œ ë©€í‹°íŒŒíŠ¸ ì²˜ë¦¬ë¥¼ ì•ˆí•˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.</p>
</li>
<li>
<p><strong><code>spring.servlet.multipart.enabled</code></strong></p>
<ul>
<li>true: ë©€í‹°íŒŒíŠ¸ ì²˜ë¦¬ O</li>
<li>false: ë©€í‹°íŒŒíŠ¸ ì²˜ë¦¬ X</li>
</ul>
</li>
<li>
<p>ì˜ˆì‹œ</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spring.servlet.multipart.enabled=false
</code></pre></div></div>
</li>
</ul>
<p><br/><br/></p>
<h2 id="section-8">ìŠ¤í”„ë§ ì—…ë¡œë“œ ì˜ˆì‹œ</h2>
<ul>
<li><strong>ìŠ¤í”„ë§ì€ <code>MultipartFile</code> ì´ë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¡œ ë©€í‹°íŒŒíŠ¸ íŒŒì¼ì„ ë§¤ìš° í¸ë¦¬í•˜ê²Œ ì§€ì›í•œë‹¤.</strong></li>
</ul>
<br/>
<h3 id="codespringuploadcontrollercode-">ì—…ë¡œë“œ ì»¨íŠ¸ë¡¤ëŸ¬: <code>SpringUploadController</code> í´ë˜ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">example.uploaddownload</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Value</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PostMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.multipart.MultipartFile</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/spring"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringUploadController</span> <span class="o">{</span>
    
    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${file.dir}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fileDir</span><span class="o">;</span>
    
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/upload"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">newFile</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"upload-form"</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/upload"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">saveFile</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="nc">String</span> <span class="n">itemName</span><span class="o">,</span>
                           <span class="nd">@RequestParam</span> <span class="nc">MultipartFile</span> <span class="n">file</span><span class="o">,</span>
                           <span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">fullPath</span> <span class="o">=</span> <span class="n">fileDir</span> <span class="o">+</span> <span class="n">file</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">();</span>
            <span class="n">file</span><span class="o">.</span><span class="na">transferTo</span><span class="o">(</span><span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="n">fullPath</span><span class="o">));</span> <span class="c1">//íŒŒì¼ ì €ì¥</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="s">"upload-form"</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>
<ul>
<li><strong><code>@RequestParam MultipartFile file</code></strong>
<ul>
<li>ì—…ë¡œë“œí•˜ëŠ” HTML Formì˜ nameì— ë§ì¶”ì–´ <code>@RequestParam</code> ì„ ì ìš©í•˜ë©´ ëœë‹¤.</li>
<li><code>@ModelAttribute</code> ì—ì„œë„ <code>MultipartFile</code> ì„ ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
<li><strong>MultipartFile ê°ì²´ì˜ ì£¼ìš” ë©”ì„œë“œ</strong>
<ul>
<li><code>file.getOriginalFilename()</code>
<ul>
<li>ì—…ë¡œë“œ íŒŒì¼ëª… ë°˜í™˜</li>
</ul>
</li>
<li><code>file.transferTo(new File(ê²½ë¡œ))</code>
<ul>
<li>íŒŒì¼ ì €ì¥</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><br/><br/></p>
<h2 id="section-9">íŒŒì¼ ì´ë¦„ ê³ ë ¤ì‚¬í•­</h2>
<ul>
<li>íŒŒì¼ì„ ì—…ë¡œë“œí•  ë•, íŒŒì¼ëª…ì— ì‹ ê²½ì„ ì¨ì•¼í•œë‹¤.</li>
<li>ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ íŒŒì¼ëª…, ì„œë²„ì— ì €ì¥í•  íŒŒì¼ëª…ì„ êµ¬ë¶„í•´ì•¼í•œë‹¤.</li>
</ul>
<h3 id="section-10">ì„œë²„ì— ì €ì¥í•  íŒŒì¼ëª…</h3>
<ul>
<li><strong>ë™ì¼í•œ íŒŒì¼ëª…ìœ¼ë¡œ ì €ì¥ì´ ë˜ë©´, íŒŒì¼ì´ ë®ì–´ì”Œì›Œì§€ê¸° ë•Œë¬¸ì— <code>UUID</code> ë“±ì„ ì´ìš©í•˜ì—¬ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” íŒŒì¼ëª…ìœ¼ë¡œ ì„œë²„ì— ì €ì¥í•´ì•¼í•œë‹¤.</strong></li>
</ul>
<h3 id="section-11">ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ íŒŒì¼ëª…</h3>
<ul>
<li>ì‚¬ìš©ìì—ê²Œ ì—…ë¡œë“œëœ íŒŒì¼ì˜ ì´ë¦„ì„ ë³´ì—¬ì¤„ ë•ŒëŠ”, â€œì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ íŒŒì¼ëª…â€ìœ¼ë¡œ ì œê³µí•´ì•¼í•œë‹¤.</li>
</ul>
<h3 id="db--">DBì— íŒŒì¼ëª… ì €ì¥</h3>
<ul>
<li>ì„œë²„ì— ì–´ë–¤ íŒŒì¼ì´ ì €ì¥ë˜ì—ˆëŠ”ì§€, íŒŒì¼ëª…ì„ DBì—ì„œ ê´€ë¦¬í•  í•„ìš”ê°€ ìˆë‹¤.</li>
<li><strong>DBì— íŒŒì¼ ì •ë³´ë¥¼ ì €ì¥í•  ë•ŒëŠ”, â€œì›ë˜ íŒŒì¼ëª…â€ê³¼ â€œì„œë²„ì— ì €ì¥ëœ ìœ ì¼í•œ íŒŒì¼ëª…â€ ëª¨ë‘ ì €ì¥í•´ì•¼í•œë‹¤.</strong></li>
</ul>
<blockquote>
<p>íŒŒì¼ ìì²´ë¥¼ DBì— ì €ì¥í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤!</p>
</blockquote>
<p><br/><br/><br/></p>
<h1 id="section-12">íŒŒì¼ ë‹¤ìš´ë¡œë“œ</h1>
<h2 id="section-13">ë‹¤ìš´ë¡œë“œ ì˜ˆì‹œ</h2>
<h3 id="codedspringfiledirmyphotopngcode">ë‹¤ìš´ë¡œë“œí•  íŒŒì¼: <code>D:\Spring\fileDir\myPhoto.png</code></h3>
<p><img src="/assets/img/2021-08-18-SPRING_MVC_UploadAndDownload/Untitled%2042.png" alt="Untitled" /></p>
<br/>
<h3 id="codesrpingdownloadcontrollercode-">ë‹¤ìš´ë¡œë“œ ì»¨íŠ¸ë¡¤ëŸ¬: <code>SrpingDownloadController</code> í´ë˜ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">example.uploaddownload</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.core.io.Resource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.core.io.UrlResource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpHeaders</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PostMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.util.UriUtils</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.MalformedURLException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.charset.StandardCharsets</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SpringDownloadController</span> <span class="o">{</span>

  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/download/form"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">downloadForm</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">return</span> <span class="s">"download-form"</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/download/file"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="nc">ResponseEntity</span><span class="o">&lt;</span><span class="nc">Resource</span><span class="o">&gt;</span> <span class="nf">downloadFile</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">MalformedURLException</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">uploadFileName</span> <span class="o">=</span> <span class="s">"myPhoto.png"</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">fullPath</span> <span class="o">=</span> <span class="s">"D:\\Spring\\fileDir\\"</span> <span class="o">+</span> <span class="n">uploadFileName</span><span class="o">;</span>
    <span class="nc">UrlResource</span> <span class="n">urlResource</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UrlResource</span><span class="o">(</span><span class="s">"file:"</span> <span class="o">+</span> <span class="n">fullPath</span><span class="o">);</span>

    <span class="c1">//ë‹¤ìš´ë¡œë“œ í•  ê²ƒì„ì„ í—¤ë”ì— ëª…ì‹œ</span>
    <span class="nc">String</span> <span class="n">encodedUploadFileName</span> <span class="o">=</span> <span class="nc">UriUtils</span><span class="o">.</span><span class="na">encode</span><span class="o">(</span><span class="n">uploadFileName</span><span class="o">,</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span> <span class="c1">//í•œê¸€ê¹¨ì§ ë°©ì§€</span>
    <span class="nc">String</span> <span class="n">contentDisposition</span> <span class="o">=</span> <span class="s">"attachment; filename=\""</span> <span class="o">+</span>
            <span class="n">encodedUploadFileName</span> <span class="o">+</span> <span class="s">"\""</span><span class="o">;</span>

		<span class="c1">//ì‘ë‹µ</span>
    <span class="k">return</span> <span class="nc">ResponseEntity</span><span class="o">.</span><span class="na">ok</span><span class="o">()</span>
            <span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="nc">HttpHeaders</span><span class="o">.</span><span class="na">CONTENT_DISPOSITION</span><span class="o">,</span> <span class="n">contentDisposition</span><span class="o">)</span>
            <span class="o">.</span><span class="na">body</span><span class="o">(</span><span class="n">urlResource</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
<li>
<p><code>header(HttpHeaders.CONTENT_DISPOSITION, contentDisposition)</code></p>
<ul>
<li>ì‘ë‹µ í—¤ë” ì„¤ì •
<ul>
<li><code>Content-Disposition: attachment; filename=&quot;myPhoto.png&quot;</code></li>
</ul>
</li>
<li>ìœ„ì™€ ê°™ì´ ì‘ë‹µ í—¤ë”ë¥¼ ì„¤ì •í•˜ë©´, ë¸Œë¼ìš°ì €ê°€ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•  ê²ƒì„ì„ ì•Œê²Œëœë‹¤.</li>
<li>ë§Œì•½ í—¤ë” ì„¤ì •ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, ë¸Œë¼ìš°ì €ëŠ” ì‘ë‹µì„ í™”ë©´ì— ì¶œë ¥í•˜ë¼ê³  ì´í•´í•œë‹¤.</li>
</ul>
</li>
<li>
<p><code>body(urlResource)</code></p>
<ul>
<li>ì‘ë‹µ ë°”ë””ì— íŒŒì¼ì´ ìœ„ì¹˜í•œ ê²½ë¡œë¥¼ ì…ë ¥í•œë‹¤.</li>
<li>í•´ë‹¹ ê²½ë¡œì— ìˆëŠ” íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ê²Œ ëœë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<h3 id="codedownload-formhtmlcode">ë‹¤ìš´ë¡œë“œ ë·° í…œí”Œë¦¿: <code>download-form.html</code></h3>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns:th=</span><span class="s">"http://www.thymeleaf.org"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Title<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"button"</span> <span class="na">th:onclick=</span><span class="s">"|location.href='@{/download/file}'|"</span><span class="nt">&gt;</span>íŒŒì¼ ë‹¤ìš´ë¡œë“œ<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>
<br/>
<h3 id="section-14">ê²°ê³¼</h3>
<p><img src="/assets/img/2021-08-18-SPRING_MVC_UploadAndDownload/Untitled%2043.png" alt="Untitled" /></p>
<br>
<hr />
<br>
<p><a href="https://inf.run/YPER"><img src="/assets/img/Inflearn_Spring_MVC2/logo.png" width="400px" height="300px"></a></p>
<ul>
<li><em>ë³¸ ê²Œì‹œê¸€ì€ ê¹€ì˜í•œë‹˜ì˜ ê°•ì˜ë¥¼ í† ëŒ€ë¡œ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤.</em></li>
<li><em>ë” ìì„¸í•œ ë‚´ìš©ì„ ì•Œê³  ì‹¶ìœ¼ì‹  ë¶„ë“¤ì´ ê³„ì‹ ë‹¤ë©´, í•´ë‹¹ ê°•ì˜ë¥¼ ìˆ˜ê°•í•˜ì‹œëŠ” ê²ƒì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.</em></li>
</ul>
:ET