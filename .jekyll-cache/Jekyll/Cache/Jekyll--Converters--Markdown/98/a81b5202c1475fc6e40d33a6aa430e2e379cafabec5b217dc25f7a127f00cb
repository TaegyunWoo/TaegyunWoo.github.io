I"¤!<p><br/><br/></p>
<h1 id="jpa-auditing----">JPA Auditingì„ í™œìš©í•œ ì—”í‹°í‹° ìƒì„±Â·ìˆ˜ì •ì‹œê°„ ìë™í™”</h1>
<h2 id="section">ê°œìš”</h2>
<h3 id="section-1">ë¬¸ì œìƒí™©</h3>
<ul>
<li>
<p>ê¸°ì¡´ì—ëŠ” ìë°”ì—ì„œ ë‚ ì§œë‚˜ ì‹œê°„ì„ í‘œí˜„í•˜ê¸° ìœ„í•´, <code>java.util.Date</code> ë‚˜ <code>java.util.Calendar</code> ë“±ì„ ì‚¬ìš©í–ˆë‹¤.</p>
</li>
<li>
<p>í•˜ì§€ë§Œ ìë°” 8ë¶€í„° ì¶”ê°€ëœ <code>LocalDate</code> ì™€ <code>LocalDateTime</code> ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ê·¸ ì´ìœ ëŠ” ëŒ€í‘œì ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ë‹¤.</p>
<ul>
<li><code>java.util.Date</code> ì™€ <code>java.util.Calendar</code> ëŠ” ë¶ˆë³€ê°ì²´ê°€ ì•„ë‹ˆë‹¤.
<ul>
<li>ì¦‰ set ë©”ì„œë“œê°€ ì¡´ì¬í•œë‹¤.</li>
<li>ë”°ë¼ì„œ ë©€í‹°ì“°ë ˆë“œ í™˜ê²½ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
<li><code>java.util.Calendar</code> ëŠ” ì›”(month) ê°’ ì„¤ê³„ê°€ ì˜ëª»ë˜ì—ˆë‹¤.
<ul>
<li>10ì›”ì„ ë‚˜íƒ€ë‚´ëŠ” <code>Calendar.OCTOBER</code> ì˜ ìˆ«ì ê°’ì€ â€˜9â€™ì´ë‹¤.</li>
</ul>
</li>
<li><code>java.util.Calendar</code> ì— int ìƒìˆ˜ í•„ë“œê°€ ë‚¨ìš©ë˜ì–´ìˆë‹¤.
<ul>
<li>
<p>2ì´ˆë¥¼ ë”í•˜ëŠ” ì½”ë“œë¥¼ ì˜ˆì‹œë¡œ ë³´ì. ì´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">calendar</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Calendar</span><span class="o">.</span><span class="na">SECOND</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
</code></pre></div></div>
</li>
<li>
<p>ë§Œì•½ ì´ë•Œ ì‹¤ìˆ˜ë¡œ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í–ˆë‹¤ê³  í•´ë³´ì.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">calendar</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">Calendar</span><span class="o">.</span><span class="na">OCTOBER</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
</code></pre></div></div>
</li>
<li>
<p>ìœ„ ì½”ë“œì²˜ëŸ¼ ì‘ì„±í•˜ì—¬ë„ ì»´íŒŒì¼ ì‹œì ì—ì„œ í•´ë‹¹ ì˜¤ë¥˜ë¥¼ ì°¾ì•„ë‚¼ ìˆ˜ ì—†ë‹¤.</p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>ì´ì™¸ì—ë„ ë§ì€ ë¬¸ì œê°€ ìˆë‹¤.<br />
ìì„¸í•œ ê²ƒì€ <a href="https://d2.naver.com/helloworld/645609">https://d2.naver.com/helloworld/645609</a> ì„ ì°¸ê³ í•˜ì.</p>
</blockquote>
</li>
</ul>
<br/>
<h3 id="section-2">ë¬¸ì œ í•´ê²° ë°©ì•ˆ</h3>
<ul>
<li>ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì Java8ë¶€í„° ì¶”ê°€ëœ ê²ƒì´ ë°”ë¡œ <code>LocalDate</code> ì™€ <code>LocalDateTime</code> ì´ë‹¤.
<ul>
<li>ë˜í•œ Hibernate 5.2.10 ë²„ì „ë¶€í„° <code>LocalDate</code> ì™€ <code>LocalDateTime</code> ì„ ë³¸ê²©ì ìœ¼ë¡œ ì§€ì›í•˜ê¸° ì‹œì‘í–ˆë‹¤.</li>
<li>ë§Œì•½ ë³¸ì¸ì´ <code>JPA 2.1</code>ì„ êµ¬í˜„í•˜ëŠ” <code>Hibernate 4.3.x</code> ë¥¼ ì‚¬ìš©í•œë‹¤ë©´, <a href="http://blog.eomdev.com/java/2016/01/04/jpa_with_java8.html">http://blog.eomdev.com/java/2016/01/04/jpa_with_java8.html</a> ë¥¼ ì°¸ê³ í•˜ì.</li>
</ul>
</li>
</ul>
<p><br/><br/></p>
<h2 id="jpa-auditing">JPA Auditing</h2>
<h3 id="jpa-auditing-1">JPA Auditingì´ë€?</h3>
<br/>
<blockquote>
<p>Audit: ê°ì‹œí•˜ë‹¤</p>
</blockquote>
<br/>
<ul>
<li>JPA Auditing ì´ë€, Spring Data JPAì—ì„œ ì‹œê°„ì— ëŒ€í•´, ìë™ìœ¼ë¡œ ê°’ì„ ë„£ì–´ì£¼ëŠ” ê¸°ëŠ¥ì´ë‹¤.
<ul>
<li>ë„ë©”ì¸ì„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥í•˜ê±°ë‚˜ ì¡°íšŒë¥¼ ìˆ˜í–‰í•œ í›„ì— UPDATEë¥¼ í•˜ëŠ” ê²½ìš°, ë§¤ë²ˆ ì‹œê°„ ë°ì´í„°ë¥¼ ì…ë ¥í•´ ì£¼ì–´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì„ <code>JPA Auditing</code> ê¸°ëŠ¥ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<h3 id="jpa-auditing-">JPA Auditing ì‚¬ìš©</h3>
<ul>
<li>Javaì—ì„œ JPAë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ì„ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— ë§¤í•‘í•  ë•Œ, ê° ë„ë©”ì¸ë“¤ì´ ê³µí†µì ìœ¼ë¡œ ê°€ì§€ê³  ìˆëŠ” í•„ë“œÂ·ì¹¼ëŸ¼ì´ ì¡´ì¬í•œë‹¤.
<ul>
<li>ëŒ€í‘œì ìœ¼ë¡œ ìƒì„±ì¼ì, ìˆ˜ì •ì¼ì ë“±ê³¼ ê°™ì€ í•„ë“œÂ·ì¹¼ëŸ¼ì´ ì¡´ì¬í•œë‹¤.</li>
</ul>
</li>
<li>ë”°ë¼ì„œ <code>@MappedSuperclass</code> ë¥¼ í†µí•´, ìƒì„±ì¼ìë‚˜ ìˆ˜ì •ì¼ìì™€ ê°™ì€ ê³µí†µ í•„ë“œë¥¼ ë¬¶ì–´ì„œ ê´€ë¦¬í•´ì•¼ í•œë‹¤.</li>
<li><strong>ì¦‰, <code>JPA Auditing</code> ê¸°ëŠ¥ê³¼ <code>@MappedSuperclass</code> ë¥¼ ì¡°í•©í•˜ì—¬ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</strong></li>
</ul>
<p><br/><br/></p>
<h2 id="section-3">ì—”í‹°í‹° ìƒì„±Â·ìˆ˜ì •ì‹œê°„ ìë™í™” ì˜ˆì‹œ ì½”ë“œ</h2>
<p>ë°”ë¡œ ì˜ˆì‹œ ì½”ë“œë¥¼ í†µí•´ ì•Œì•„ë³´ì.</p>
<h3 id="codebasetimeentitycode-"><code>BaseTimeEntity</code> í´ë˜ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Getter</span>
<span class="nd">@MappedSuperclass</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="nc">AuditingEntityListener</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BaseTimeEntity</span> <span class="o">{</span>
	<span class="nd">@CreatedDate</span>
	<span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">createdDate</span><span class="o">;</span>

	<span class="nd">@LastModifiedDate</span>
	<span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">modifiedDate</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
<li><code>@MappedSuperclass</code> ì• ë„ˆí…Œì´ì…˜
<ul>
<li>ë”°ë¼ì„œ <code>BaseTimeEntity</code> í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” ë‹¤ë¥¸ ì—”í‹°í‹° í´ë˜ìŠ¤ë“¤ì´ í•´ë‹¹ í•„ë“œë“¤(<code>createdDate</code> , <code>modifiedDate</code>)ë¥¼ ì—”í‹°í‹° í•„ë“œë¡œì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
<li><code>@EntityListeners(AuditingEntityListener.class)</code>
<ul>
<li>ì˜ì†ì„± ë©”ì»¤ë‹ˆì¦˜ìƒì—ì„œ ì´ë²¤íŠ¸(ìš°ë¦¬ì˜ ê²½ìš°, ì—”í‹°í‹° ì €ì¥Â·ìˆ˜ì •)ê°€ ë°œìƒí•  ë•Œ í˜¸ì¶œí•´ì¤„ Listener í´ë˜ìŠ¤ë¥¼ ì§€ì •í•œë‹¤.</li>
<li>ì¦‰, <code>BaseTimeEntity</code> í´ë˜ìŠ¤ì— <code>Auditing</code> ê¸°ëŠ¥ì„ í¬í•¨ì‹œí‚¨ë‹¤.</li>
</ul>
</li>
<li><code>@CreatedDate</code>
<ul>
<li>Entityê°€ ìƒì„±ë˜ì–´ ì €ì¥ë  ë•Œ ì‹œê°„ì´ ìë™ ì €ì¥ëœë‹¤.</li>
</ul>
</li>
<li><code>@LastModifiedDate</code>
<ul>
<li>ì¡°íšŒí•œ Entityì˜ ê°’ì„ ë³€ê²½í•  ë•Œ ì‹œê°„ì´ ìë™ ì €ì¥ëœë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<h3 id="codepostcode--"><code>Post</code> ì—”í‹°í‹° í´ë˜ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Post</span> <span class="kd">extends</span> <span class="nc">BaseTimeEntity</span> <span class="o">{</span>
	<span class="c1">//...</span>
<span class="o">}</span>
</code></pre></div></div>
<ul>
<li><code>BaseTimeEntity</code> ë¥¼ ìƒì†ë°›ì•„ <code>createdTime</code> í•„ë“œì™€ <code>modifiedTime</code> í•„ë“œë¥¼ ì‚¬ìš©í•œë‹¤.</li>
</ul>
<br/>
<h3 id="codeapplicationcode-"><code>Application</code> í´ë˜ìŠ¤</h3>
<blockquote>
<p>ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ë™ í´ë˜ìŠ¤ (<code>main</code> ë©”ì„œë“œ ì¡´ì¬ í´ë˜ìŠ¤)</p>
</blockquote>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@EnableJpaAuditing</span> <span class="c1">//JPA Auditing í™œì„±í™”</span>
<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">Application</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span> 
</code></pre></div></div>
<p><br/><br/></p>
<h2 id="reference">REFERENCE</h2>
<ul>
<li><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#auditing">https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#auditing</a></li>
<li><a href="https://it-mesung.tistory.com/195">https://it-mesung.tistory.com/195</a></li>
<li><a href="http://blog.eomdev.com/java/2016/01/04/jpa_with_java8.html">http://blog.eomdev.com/java/2016/01/04/jpa_with_java8.html</a></li>
<li><a href="https://webcoding-start.tistory.com/53">https://webcoding-start.tistory.com/53</a></li>
</ul>
<p><br><br></p>
:ET