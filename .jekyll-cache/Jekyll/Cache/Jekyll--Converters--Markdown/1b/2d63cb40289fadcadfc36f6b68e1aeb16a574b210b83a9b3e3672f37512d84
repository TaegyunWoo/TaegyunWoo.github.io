I";<p><br/><br/></p>
<h1 id="mybatis-springboot">MyBatisì™€ SpringBoot</h1>
<p><a href="https://github.com/TaegyunWoo/TaegyunWoo.github.io/blob/master/ExampleProjects/mybatis.zip">ì˜ˆì œ í”„ë¡œì íŠ¸ ë‹¤ìš´ë¡œë“œ</a></p>
<p><br/><br/></p>
<h2 id="section">ê°œìš”</h2>
<ul>
<li>ìŠ¤í”„ë§ë¶€íŠ¸, ë§ˆì´ë°”í‹°ìŠ¤, H2 DB ë¥¼ ì´ìš©í•œë‹¤.</li>
<li>ì˜ˆì‹œ í”„ë¡œì íŠ¸ëŠ” ì–´ë…¸í…Œì´ì…˜ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆë‹¤.</li>
</ul>
<h2 id="mybatis-">MyBatis ì‚¬ìš©</h2>
<h3 id="mapper">Mapperë€?</h3>
<ul>
<li>sqlê³¼ ë§¤í•‘í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤.</li>
<li>ì¸í„°í˜ì´ìŠ¤ì— <code>@Mapper</code> ë¡œ ëª…ì‹œí•œë‹¤.</li>
</ul>
<br/>
<h3 id="codeinsertcode--codeparamcode"><code>@Insert</code> ì™€ <code>@Param</code></h3>
<ul>
<li><code>@Param(&quot;ì¿¼ë¦¬ë¡œ ì „ë‹¬í•  íŒŒë¼ë¯¸í„° ì´ë¦„&quot;)</code>
<ul>
<li><code>ì¿¼ë¦¬ë¡œ ì „ë‹¬í•  íŒŒë¼ë¯¸í„° ì´ë¦„</code>: í•´ë‹¹ ì´ë¦„ì˜ íŒŒë¼ë¯¸í„°ë¥¼ <code>#{}</code> ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
<li>ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„° ë ˆë²¨ì— ì‘ì„±í•œë‹¤.</li>
<li>í•´ë‹¹ íŒŒë¼ë¯¸í„°ë¥¼ ì¿¼ë¦¬ë¬¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li><code>@Insert(&quot;INSERT ì¿¼ë¦¬&quot;)</code>
<ul>
<li>ë°˜í™˜ê°’ì€ intì´ì–´ì•¼í•œë‹¤.</li>
<li>ë°˜í™˜ê°’: ì‚½ì…ì— ì„±ê³µí•œ íŠœí”Œì˜ ê°œìˆ˜</li>
</ul>
</li>
</ul>
<br/>
<ul>
<li>
<p>ì‚¬ìš© ì˜ˆì‹œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@Insert</span><span class="o">(</span><span class="s">"INSERT INTO user(email, name, password) VALUES (#{user.email}, #{user.name}, #{user.password})"</span><span class="o">)</span>
<span class="kt">int</span> <span class="nf">insert</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> <span class="nc">User</span> <span class="n">user</span><span class="o">);</span>


</code></pre></div></div>
</li>
</ul>
<br/>
<h3 id="codeselectcode--coderesultscode"><code>@Select()</code> ì™€ <code>@Results</code></h3>
<ul>
<li><code>@Select(&quot;SELECT ì¿¼ë¦¬&quot;)</code></li>
</ul>
<br/>
<ul>
<li><code>@Result( id=&quot;ë§µid&quot;, value={ @Result(property=&quot;ë§¤í•‘í• _í•„ë“œëª…&quot;, column=&quot;ë§¤í•‘í• _ì¹¼ëŸ¼ëª…&quot;), ... } )</code>
<ul>
<li>id ì†ì„±ì„ í†µí•´, ë‹¤ë¥¸ ë©”ì„œë“œì—ì„œ ë§¤í•‘ì •ë³´ë¥¼ ì¬í™œìš©í•  ìˆ˜ ìˆë‹¤.</li>
<li><code>@Select</code> ê²½ìš°, <code>@Results</code> ì™€ <code>@Result</code> ë¥¼ í†µí•´ ì¹¼ëŸ¼ê³¼ í•„ë“œ ê°„ì˜ ë§¤í•‘ì„ ì§„í–‰í•´ì•¼í•œë‹¤.</li>
<li><code>@Insert</code> ê²½ìš°, <code>#{}</code> ë¥¼ í†µí•´ ë§¤í•‘í•œë‹¤.</li>
<li><strong>ì¹¼ëŸ¼ëª…ê³¼ í•„ë“œëª…ì´ ê°™ë‹¤ë©´ <code>@Results</code> ë¥¼ ìƒëµí•  ìˆ˜ ìˆë‹¤.</strong></li>
</ul>
</li>
</ul>
<br/>
<ul>
<li>
<p>ì‚¬ìš© ì˜ˆì‹œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="c1">//-----------ì¡°ê±´ ì—†ì´ SELECT-------------</span>
<span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM user"</span><span class="o">)</span>
<span class="nd">@Results</span><span class="o">(</span><span class="n">id</span><span class="o">=</span><span class="s">"myResultId"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="o">{</span>
        <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">),</span>
        <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"email"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"email"</span><span class="o">),</span>
        <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">),</span>
        <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"password"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"password"</span><span class="o">)</span>
<span class="o">})</span> <span class="c1">//í•„ë“œëª…ê³¼ ì»¬ëŸ¼ëª…ì´ ê°™ìœ¼ë©´ @Results ëŠ” í•„ìš”ì—†ë‹¤.</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getAll</span><span class="o">();</span>

<span class="c1">//-----------ì¡°ê±´ê³¼ í•¨ê»˜ SELECT-------------</span>
<span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM user WHERE dbid=#{id}"</span><span class="o">)</span>
<span class="nd">@ResultMap</span><span class="o">(</span><span class="s">"myResultId"</span><span class="o">)</span> <span class="c1">//ë§¤í•‘ì •ë³´ ì¬í™œìš©</span>
<span class="nc">User</span> <span class="nf">getById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">);</span>


</code></pre></div></div>
</li>
</ul>
<br/>
<h3 id="codeupdatecode"><code>@Update()</code></h3>
<ul>
<li>
<p><code>@Update(&quot;UPDATE ì¿¼ë¦¬&quot;)</code></p>
<ul>
<li>ë°˜í™˜ê°’ì€ intí˜•ì´ë‹¤.</li>
<li>ìˆ˜ì •ëœ íŠœí”Œì˜ ê°œìˆ˜ë¥¼ ë°˜í™˜í•œë‹¤.</li>
</ul>
</li>
<li>
<p>ì‚¬ìš© ì˜ˆì‹œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="nd">@Update</span><span class="o">(</span><span class="s">"update user set name=#{user.name}, password=#{user.password} where dbid=#{user.dbid}"</span><span class="o">)</span>
<span class="kt">int</span> <span class="nf">updateById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> <span class="nc">User</span> <span class="n">user</span><span class="o">);</span>


</code></pre></div></div>
</li>
</ul>
<br/>
<h3 id="codedeletecode"><code>@Delete</code></h3>
<ul>
<li>
<p><code>@Delete(&quot;DELETE ì¿¼ë¦¬&quot;)</code></p>
<ul>
<li>ë°˜í™˜ê°’ì€ intí˜•ì´ë‹¤.</li>
<li>ì‚­ì œëœ íŠœí”Œì˜ ê°œìˆ˜ë¥¼ ë°˜í™˜í•œë‹¤.</li>
</ul>
</li>
<li>
<p>ì‚¬ìš© ì˜ˆì‹œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="nd">@Delete</span><span class="o">(</span><span class="s">"delete from membertab where dbid=#{dbid}"</span><span class="o">)</span>
<span class="kt">int</span> <span class="nf">deleteById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"dbid"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">);</span>


</code></pre></div></div>
</li>
</ul>
<br/>
<h3 id="codeoptionscode"><code>@Options</code></h3>
<ul>
<li><code>@Options( userGeneratedKeys=true, keyProperty=&quot;í‚¤_í•„ë“œ&quot;, keyColumn=&quot;í‚¤_ì• íŠ¸ë¦¬ë·°íŠ¸&quot; )</code>
<ul>
<li>
<p>ìœ„ì™€ ê°™ì´ ì‘ì„±í•˜ë©´, <strong>SQLì—ì„œ ìƒì„±ëœ ê°’(AUTO_INCREMENT ë“±)ì´ ë§¤í•‘ëœ ê°ì²´ì˜ í•„ë“œì— ì—­ìœ¼ë¡œ ë°”ì¸ë”©ëœë‹¤.</strong></p>
</li>
<li>
<p>ì‚¬ìš© ì˜ˆì‹œ</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="nd">@Insert</span><span class="o">(</span><span class="s">"INSERT INTO user(email, name, password) VALUES (#{user.email}, #{user.name}, #{user.password})"</span><span class="o">)</span>
<span class="nd">@Options</span><span class="o">(</span><span class="n">useGeneratedKeys</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">keyProperty</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">,</span> <span class="n">keyColumn</span><span class="o">=</span><span class="s">"dbid"</span><span class="o">)</span> <span class="c1">//SQLì´ ìƒì„±í•œ KEY ê°’ì„ ë§¤í•‘ëœ ê°ì²´ì˜ dbid í•„ë“œì—ë„ ë‹´ì•„ì£¼ê² ë‹¤.</span>
<span class="kt">int</span> <span class="nf">insert</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> <span class="nc">User</span> <span class="n">user</span><span class="o">);</span>


</code></pre></div></div>
</li>
</ul>
</li>
</ul>
<br/>
<h3 id="codetransactionalcode"><code>@Transactional</code></h3>
<ul>
<li>í•´ë‹¹ ë©”ì„œë“œë¥¼ í•˜ë‚˜ì˜ DB ì‘ì—…ë‹¨ìœ„(íŠ¸ëœì­ì…˜)ë¡œ ì§€ì •í•œë‹¤.</li>
<li><strong>í•´ë‹¹ ì• ë„ˆí…Œì´ì…˜ì´ ë¶™ì€ ë©”ì„œë“œ (ë³´í†µ ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œ)ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´, í•´ë‹¹ ë©”ì„œë“œê°€ ì‘ì—…í•œ íŠ¸ëœì­ì…˜ (ë§¤í¼ë¥¼ í†µí•´ ìˆ˜í–‰í•œ DB ì‘ì—…)ì€ ëª¨ë‘ ë¡¤ë°±ëœë‹¤.</strong></li>
<li>ë¡¤ë°±í•  ì˜ˆì™¸ ì„¤ì •
<ul>
<li><code>@Transactional(rollbackFor=ì„¤ì •í• _ì˜ˆì™¸.class)</code></li>
<li>í•´ë‹¹ ì˜ˆì™¸ì™€ ìì‹ ì˜ˆì™¸ê¹Œì§€ ì²˜ë¦¬í•œë‹¤.</li>
<li>ì²˜ë¦¬í•  ì˜ˆì™¸ì˜ Defaultê°’ = <code>RuntimeException.class</code></li>
</ul>
</li>
</ul>
<p><br/><br/></p>
<h2 id="codemanycode">1ëŒ€ë‹¤ ê´€ê³„ ì²˜ë¦¬: <code>@Many</code></h2>
<h3 id="erd">ì˜ˆì‹œ ERD</h3>
<p><img src="/assets/img/2021-09-01-MyBatis_MyBatisFunction/Untitled%203.png" alt="Untitled" /></p>
<br/>
<h3 id="user-">User í´ë˜ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="cm">/**
 * ì‚¬ìš©ì ì •ë³´ ë„ë©”ì¸
 */</span>
<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="nc">Long</span> <span class="n">dbid</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>

  <span class="c1">//1ëŒ€ë‹¤ ê´€ê³„ ì„¤ì • (1: User, ë‹¤: Phone)</span>
  <span class="c1">//í…Œì´ë¸”ì— í•´ë‹¹ ì»¬ëŸ¼ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.</span>
  <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Phone</span><span class="o">&gt;</span> <span class="n">phoneList</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<br/>
<h3 id="phone-">Phone í´ë˜ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>

<span class="cm">/**
 * í•¸ë“œí° ì •ë³´ ë„ë©”ì¸
 */</span>
<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Phone</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">dbid</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">number</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<br/>
<h3 id="phonemapper-">PhoneMapper ì¸í„°í˜ì´ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM phone WHERE id=#{id}"</span><span class="o">)</span>
<span class="c1">//@Results ìƒëµ</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Phone</span><span class="o">&gt;</span> <span class="nf">getByUserDbId</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">);</span>
</code></pre></div></div>
<br/>
<h3 id="usermapper-">UserMapper ì¸í„°í˜ì´ìŠ¤</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM user"</span><span class="o">)</span>
<span class="nd">@Results</span><span class="o">(</span><span class="nd">@Result</span><span class="o">(</span><span class="n">property</span><span class="o">=</span><span class="s">"phoneList"</span><span class="o">,</span> <span class="n">column</span><span class="o">=</span><span class="s">"dbid"</span><span class="o">,</span> <span class="n">many</span><span class="o">=</span><span class="nd">@Many</span><span class="o">(</span><span class="n">select</span><span class="o">=</span><span class="s">"íŒ¨í‚¤ì§€ëª….Phone.getByUserDbId"</span><span class="o">)))</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getAll</span><span class="o">();</span>
</code></pre></div></div>
<ul>
<li><code>property=&quot;phoneList&quot;</code>
<ul>
<li>User.phoneList í•„ë“œì— ì €ì¥í•˜ê² ë‹¤.</li>
</ul>
</li>
<li><code>column=&quot;dbid&quot;</code>
<ul>
<li>â€œUser í…Œì´ë¸”ì˜ dbid ì¹¼ëŸ¼ì˜ ê°’â€ì„ â€œ<code>@Many</code> ë¡œ ì§€ì •í•œ ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°â€ë¡œ ì „ë‹¬í•˜ê² ë‹¤.</li>
</ul>
</li>
<li><code>many=@Many(select=&quot;íŒ¨í‚¤ì§€ëª….ë§¤í¼_ì¸í„°í˜ì´ìŠ¤ëª….ë©”ì„œë“œëª…&quot;)</code>
<ul>
<li>í•´ë‹¹ ë§¤í¼ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê² ë‹¤.</li>
<li>ê·¸ë¦¬ê³  ê·¸ ê²°ê³¼ë¥¼ User.phoneList í•„ë“œì— ì €ì¥í•˜ê² ë‹¤.</li>
</ul>
</li>
</ul>
<p><br/><br/></p>
<h2 id="section-1">í™œìš© ì˜ˆì‹œ</h2>
<h3 id="erd-1">ERD</h3>
<p><img src="/assets/img/2021-09-01-MyBatis_MyBatisFunction/Untitled%203.png" alt="Untitled" /></p>
<br/>
<h3 id="data--codeusercode">Data ê°ì²´: <code>User</code></h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="cm">/**
 * ì‚¬ìš©ì ì •ë³´ ë„ë©”ì¸
 */</span>
<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="nc">Long</span> <span class="n">dbid</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>

  <span class="c1">//1ëŒ€ë‹¤ ê´€ê³„ ì„¤ì • (1: User, ë‹¤: Phone)</span>
  <span class="c1">//í…Œì´ë¸”ì— í•´ë‹¹ ì»¬ëŸ¼ì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.</span>
  <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Phone</span><span class="o">&gt;</span> <span class="n">phoneList</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<br/>
<h3 id="mapper-codeusermappercode">Mapper: <code>UserMapper</code></h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@Mapper</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>

  <span class="c1">//Create</span>
  <span class="nd">@Insert</span><span class="o">(</span><span class="s">"INSERT INTO user(email, name, password) VALUES (#{user.email}, #{user.name}, #{user.password})"</span><span class="o">)</span>
  <span class="nd">@Options</span><span class="o">(</span><span class="n">useGeneratedKeys</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">keyProperty</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">)</span> <span class="c1">//SQLì´ ìƒì„±í•œ KEY ê°’ì„ ë§¤í•‘ëœ ê°ì²´ì˜ dbid í•„ë“œì—ë„ ë‹´ì•„ì£¼ê² ë‹¤.</span>
  <span class="kt">int</span> <span class="nf">insert</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span> <span class="nc">User</span> <span class="n">user</span><span class="o">);</span>

  <span class="c1">//Read - 1</span>
  <span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM user"</span><span class="o">)</span>
  <span class="nd">@Results</span><span class="o">(</span><span class="n">id</span><span class="o">=</span><span class="s">"myResultId"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="o">{</span>
          <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">),</span>
          <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"email"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"email"</span><span class="o">),</span>
          <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">),</span>
          <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"password"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"password"</span><span class="o">),</span>
          <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"phoneList"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">,</span> <span class="n">many</span> <span class="o">=</span> <span class="nd">@Many</span><span class="o">(</span><span class="n">select</span> <span class="o">=</span> <span class="s">"test.mybatis.domain.PhoneMapper.getByUserId"</span><span class="o">))</span>
  <span class="o">})</span> <span class="c1">//í•„ë“œëª…ê³¼ ì»¬ëŸ¼ëª…ì´ ê°™ìœ¼ë©´ @Results ëŠ” í•„ìš”ì—†ë‹¤.</span>
  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getAll</span><span class="o">();</span>

  <span class="c1">//Read - 2</span>
  <span class="c1">//@Results ì¬í™œìš©</span>
  <span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM user WHERE dbid=#{id}"</span><span class="o">)</span>
  <span class="nd">@ResultMap</span><span class="o">(</span><span class="s">"myResultId"</span><span class="o">)</span>
  <span class="nc">User</span> <span class="nf">getById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<br/>
<h3 id="data--codephonecode">Data ê°ì²´: <code>Phone</code></h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>

<span class="cm">/**
 * í•¸ë“œí° ì •ë³´ ë„ë©”ì¸
 */</span>
<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Phone</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">dbid</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">number</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<br/>
<h3 id="mapper-codephonemappercode">Mapper: <code>PhoneMapper</code></h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@Mapper</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">PhoneMapper</span> <span class="o">{</span>
    <span class="c1">//Create</span>
    <span class="nd">@Insert</span><span class="o">(</span><span class="s">"INSERT INTO phone(number, dbid) VALUES (#{phone.number}, #{phone.dbid})"</span><span class="o">)</span>
    <span class="nd">@Options</span><span class="o">(</span><span class="n">useGeneratedKeys</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">keyProperty</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span> <span class="c1">//SQLì´ ìƒì„±í•œ KEY ê°’ì„ ë§¤í•‘ëœ ê°ì²´ì˜ dbid í•„ë“œì—ë„ ë‹´ì•„ì£¼ê² ë‹¤.</span>
    <span class="kt">int</span> <span class="nf">insert</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"phone"</span><span class="o">)</span> <span class="nc">Phone</span> <span class="n">phone</span><span class="o">);</span>

    <span class="c1">//Read - 1</span>
    <span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM phone"</span><span class="o">)</span>
    <span class="nd">@Results</span><span class="o">(</span><span class="n">id</span><span class="o">=</span><span class="s">"phoneId"</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="o">{</span>
            <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">),</span>
            <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"number"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"number"</span><span class="o">),</span>
            <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">,</span> <span class="n">column</span> <span class="o">=</span> <span class="s">"dbid"</span><span class="o">)</span>
    <span class="o">})</span> <span class="c1">//í•„ë“œëª…ê³¼ ì»¬ëŸ¼ëª…ì´ ê°™ìœ¼ë©´ @Results ëŠ” í•„ìš”ì—†ë‹¤.</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Phone</span><span class="o">&gt;</span> <span class="nf">getAll</span><span class="o">();</span>

    <span class="c1">//Read - 2</span>
    <span class="c1">//@Results ì¬í™œìš©</span>
    <span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM phone WHERE id=#{id}"</span><span class="o">)</span>
    <span class="nd">@ResultMap</span><span class="o">(</span><span class="s">"phoneId"</span><span class="o">)</span>
    <span class="nc">Phone</span> <span class="nf">getById</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">);</span>

    <span class="nd">@Select</span><span class="o">(</span><span class="s">"SELECT * FROM phone WHERE dbid=#{dbid}"</span><span class="o">)</span>
    <span class="nd">@ResultMap</span><span class="o">(</span><span class="s">"phoneId"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Phone</span><span class="o">&gt;</span> <span class="nf">getByUserId</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">"dbid"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">dbid</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>
<br/>
<h3 id="codeusercontrollercode">ì»¨íŠ¸ë¡¤ëŸ¬: <code>UserController</code></h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.RequiredArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">test.mybatis.domain.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">test.mybatis.domain.UserMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">test.mybatis.service.UserService</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/user"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserMapper</span> <span class="n">userMapper</span><span class="o">;</span>

    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/insert"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">insertUser</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">userMapper</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/selectAll"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">selectAllUser</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getAll</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/selectById/{id}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">User</span> <span class="nf">selectById</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getById</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>
<br/>
<h3 id="codephonecontrollercode">ì»¨íŠ¸ë¡¤ëŸ¬: <code>PhoneController</code></h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">lombok.RequiredArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">test.mybatis.domain.Phone</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">test.mybatis.domain.PhoneMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">test.mybatis.domain.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">test.mybatis.domain.UserMapper</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/phone"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PhoneController</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">PhoneMapper</span> <span class="n">phoneMapper</span><span class="o">;</span>

    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/insert"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Phone</span> <span class="nf">insertPhone</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">Phone</span> <span class="n">phone</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">phoneMapper</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">phone</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">phone</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/selectAll"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Phone</span><span class="o">&gt;</span> <span class="nf">selectAllPhone</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">phoneMapper</span><span class="o">.</span><span class="na">getAll</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/selectById/{id}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Phone</span> <span class="nf">selectById</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">phoneMapper</span><span class="o">.</span><span class="na">getById</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>
<p><br/><br/></p>
<h2 id="section-2">ë¡œê¹…í•˜ê¸°</h2>
<h3 id="codeapplicationpropertiescode-"><code>application.properties</code> íŒŒì¼</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logging</span><span class="o">.</span><span class="na">level</span><span class="o">.</span><span class="na">íŒ¨í‚¤ì§€ëª…</span><span class="o">.</span><span class="na">ë§¤í¼_ì¸í„°í˜ì´ìŠ¤ëª…</span><span class="o">=</span><span class="no">TRACE</span>
</code></pre></div></div>
<ul>
<li>SQL ì¿¼ë¦¬ë¬¸ê³¼ ê²°ê³¼ê°’ì´ ë¡œê¹…ëœë‹¤.</li>
</ul>
:ET